<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sacred Daniel's Empire | Maritime Kingdom Since 1700 | –ú–æ—Ä—Å–∫–∞—è –ò–º–ø–µ—Ä–∏—è</title>
    <meta name="description" content="Official sovereign maritime state with pirate traditions and naval heritage. –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç –º–æ—Ä—Å–∫–æ–π –∏–º–ø–µ—Ä–∏–∏ —Å —Ç—Ä–∞–¥–∏—Ü–∏—è–º–∏ –∫–æ—Ä–∞–±–ª–µ—Å—Ç—Ä–æ–µ–Ω–∏—è –∏ –ø–∏—Ä–∞—Ç—Å—Ç–≤–∞">
    <meta name="keywords" content="Sacred Daniel's Empire, maritime kingdom, ships, piracy, naval history, Spain colonial era, British navy, marine research, –º–æ—Ä—Å–∫–∞—è –∏–º–ø–µ—Ä–∏—è, –∫–æ—Ä–∞–±–ª–∏, –ø–∏—Ä–∞—Ç—Å—Ç–≤–æ, –∞–±—Å–æ–ª—é—Ç–Ω–∞—è –º–æ–Ω–∞—Ä—Ö–∏—è, –ò—Å–ø–∞–Ω–∏—è, –ë—Ä–∏—Ç–∞–Ω–∏—è">
    <meta name="author" content="Imperial Office of Sacred Daniel's Empire">
    
    <meta property="og:title" content="Sacred Daniel's Empire | Maritime Power Since 1700">
    <meta property="og:description" content="Sovereign naval state with pirate traditions connecting Spain and Britain heritage">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://daniel321-5.github.io/Sacred.Empire/#">
    <meta property="og:image" content="https://daniel321-5.github.io/Sacred.Empire/TBA-SITE/imperial_flag.webp">
    <meta property="og:locale" content="en_US">
    <meta property="og:locale:alternate" content="ru_RU">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Sacred Daniel's Empire | Naval Heritage">
    <meta name="twitter:description" content="Golden Age of Piracy legacy and maritime traditions">
    <meta name="science-keywords" content="marine biology research, Dark Sea anomaly, Prophet Daniel Marine Life Research Center, oceanographic studies, cephalopod morphology, cartilaginous fishes, marine anomalies, oceanic gigantism, behavioral ecology, Pairo.P research, Vladislav.V marine studies, Def State Scientific Institute, marine expeditions 19th century, sea monster research, abyssal zone studies, marine fauna adaptation, oceanic exploration history, marine science empire, biological research institute">

    <meta name="science-keywords-ru" content="–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –º–æ—Ä—Å–∫–æ–π –±–∏–æ–ª–æ–≥–∏–∏, –∞–Ω–æ–º–∞–ª–∏—è –¢–µ–º–Ω–æ–≥–æ –º–æ—Ä—è, –ù–∞—É—á–Ω–æ-–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ü–µ–Ω—Ç—Ä –º–æ—Ä—Å–∫–æ–π –∂–∏–∑–Ω–∏ –ø—Ä–æ—Ä–æ–∫–∞ –î–∞–Ω–∏—ç–ª—è, –æ–∫–µ–∞–Ω–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è, –º–æ—Ä—Ñ–æ–ª–æ–≥–∏—è –≥–æ–ª–æ–≤–æ–Ω–æ–≥–∏—Ö, —Ö—Ä—è—â–µ–≤—ã–µ —Ä—ã–±—ã, –º–æ—Ä—Å–∫–∏–µ –∞–Ω–æ–º–∞–ª–∏–∏, –æ–∫–µ–∞–Ω–∏—á–µ—Å–∫–∏–π –≥–∏–≥–∞–Ω—Ç–∏–∑–º, –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∞—è —ç–∫–æ–ª–æ–≥–∏—è, –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –ü–∞–π—Ä–æ.–ü, –º–æ—Ä—Å–∫–∏–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –í–ª–∞–¥–∏—Å–ª–∞–≤–∞.–í, –ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –Ω–∞—É—á–Ω—ã–π –∏–Ω—Å—Ç–∏—Ç—É—Ç –î–µ—Ñ–∞, –º–æ—Ä—Å–∫–∏–µ —ç–∫—Å–ø–µ–¥–∏—Ü–∏–∏ 19 –≤–µ–∫–∞, –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –º–æ—Ä—Å–∫–∏—Ö –º–æ–Ω—Å—Ç—Ä–æ–≤, –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –∞–±–∏—Å—Å–∞–ª—å–Ω–æ–π –∑–æ–Ω—ã, –∞–¥–∞–ø—Ç–∞—Ü–∏—è –º–æ—Ä—Å–∫–æ–π —Ñ–∞—É–Ω—ã, –∏—Å—Ç–æ—Ä–∏—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –æ–∫–µ–∞–Ω–∞, –º–æ—Ä—Å–∫–∞—è –Ω–∞—É–∫–∞ –∏–º–ø–µ—Ä–∏–∏, –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Å—Ç–∏—Ç—É—Ç, –≥–ª—É–±–æ–∫–æ–≤–æ–¥–Ω—ã–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è, –≥–∏–≥–∞–Ω—Ç—Å–∫–∏–µ –∫–∞–ª—å–º–∞—Ä—ã, –Ω–∞—É—á–Ω—ã–µ —ç–∫—Å–ø–µ–¥–∏—Ü–∏–∏, –∑–æ–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è, –º–æ—Ä—Å–∫–∏–µ —á—É–¥–æ–≤–∏—â–∞, —Ç–µ–º–Ω–æ–µ –º–æ—Ä–µ, –∞–Ω–æ–º–∞–ª—å–Ω—ã–µ –º–æ—Ä—Å–∫–∏–µ —Å—É—â–µ—Å—Ç–≤–∞">
    
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "GovernmentOrganization",
      "name": "Sacred Daniel's Empire",
      "alternateName": ["–ú–æ—Ä—Å–∫–∞—è –ò–º–ø–µ—Ä–∏—è –î–∞–Ω–∏—ç–ª—è", "Daniel's Maritime Kingdom"],
      "description": "Sovereign naval power with pirate traditions | –°—É–≤–µ—Ä–µ–Ω–Ω–∞—è –º–æ—Ä—Å–∫–∞—è –¥–µ—Ä–∂–∞–≤–∞",
      "url": "https://daniel321-5.github.io/Sacred.Empire/#",
      "logo": "https://daniel321-5.github.io/Sacred.Empire/TBA-SITE/imperial_emblem.webp",
      "foundingDate": "1700",
      "keywords": [
        {"@language": "en", "@value": "ships, piracy, naval battles, Spain colonies, British fleet, History, Truth, Daniel, Sacred emperor, TBA"},
        {"@language": "ru", "@value": "–∫–æ—Ä–∞–±–ª–∏, –ø–∏—Ä–∞—Ç—Å—Ç–≤–æ, –º–æ—Ä—Å–∫–∏–µ —Å—Ä–∞–∂–µ–Ω–∏—è, –∫–æ–ª–æ–Ω–∏–∞–ª—å–Ω–∞—è –ò—Å–ø–∞–Ω–∏—è, –ë—Ä–∏—Ç–∞–Ω—Å–∫–∏–π —Ñ–ª–æ—Ç, –ò—Å—Ç–æ—Ä–∏—è, –ü—Ä–∞–≤–¥–∞, –î–∞–Ω–∏—ç–ª—å, –ë–ê, –°–≤—è—â–µ–Ω–Ω—ã–π –∏–º–ø–µ—Ä–∞—Ç–æ—Ä"}
      ],
      "founder": {
        "@type": "Person",
        "name": "Daniel De Courno",
        "description": "Emperor and naval commander | –ò–º–ø–µ—Ä–∞—Ç–æ—Ä –∏ —Ñ–ª–æ—Ç–æ–≤–æ–¥–µ—Ü"
      }
    }
    </script>
    
    <link rel="alternate" hreflang="en" href="https://daniel321-5.github.io/Sacred.Empire/#" />
    <link rel="alternate" hreflang="ru" href="https://daniel321-5.github.io/Sacred.Empire/#" />
    <link rel="alternate" hreflang="x-default" href="https://daniel321-5.github.io/Sacred.Empire/#" />
    
    <link rel="icon" href="TBA-SITE/favicon.webp" type="image/webp">
    <link rel="apple-touch-icon" href="TBA-SITE/apple-icon.webp">
    
    <link rel="canonical" href="https://daniel321-5.github.io/Sacred.Empire/#">
    
    <meta name="theme-color" content="#1a237e">
    <meta name="robots" content="index, follow">
    <meta name="revisit-after" content="7 days">

    <!-- FIREBASE –±–µ–∑ Storage -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <!-- CryptoJS for encryption -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –≤—Ö–æ–¥–∞ */
        .login-button-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }
        
        .login-button {
            background-color: #1a237e;
            color: gold;
            border: 2px solid gold;
            border-radius: 5px;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            font-family: 'Times New Roman', serif;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .login-button:hover {
            background-color: #303f9f;
            transform: scale(1.05);
        }
        
        /*  –°—Ç–∏–ª–∏ –¥–ª—è –º–µ–Ω—é */
        .user-menu {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: none;
        }
        
        .user-menu.active {
            display: block;
        }
        
        .user-button {
            background-color: #1a237e;
            color: gold;
            border: 2px solid gold;
            border-radius: 5px;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            font-family: 'Times New Roman', serif;
            font-weight: bold;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .user-button:hover {
            background-color: #303f9f;
        }
        
        .dropdown-menu {
            position: absolute;
            top: 100%;
            right: 0;
            background-color: #1a237e;
            border: 2px solid gold;
            border-radius: 5px;
            min-width: 200px;
            margin-top: 5px;
            display: none;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .dropdown-menu.active {
            display: block;
        }
        
        .dropdown-menu button {
            width: 100%;
            padding: 12px 20px;
            background: none;
            border: none;
            color: gold;
            text-align: left;
            cursor: pointer;
            font-family: 'Times New Roman', serif;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        
        .dropdown-menu button:hover {
            background-color: #303f9f;
        }
        
        .chat-buttons {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .chat-buttons button {
            width: 100%;
            padding: 12px 20px;
            background: none;
            border: none;
            color: gold;
            text-align: left;
            cursor: pointer;
            font-family: 'Times New Roman', serif;
            font-size: 16px;
            transition: background-color 0.3s;
            border-left: 3px solid transparent;
        }
        
        .chat-buttons button:hover {
            background-color: #303f9f;
            border-left-color: gold;
        }
        
        .chat-buttons .unread-badge {
            float: right;
            background-color: gold;
            color: #1a237e;
            border-radius: 50%;
            padding: 2px 6px;
            font-size: 12px;
            font-weight: bold;
        }
        
        /*  –°—Ç–∏–ª–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            max-width: 800px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            border: 3px solid #1a237e;
            position: relative;
        }
        
        body.dark-mode .modal-content {
            background-color: #1e1e1e;
            color: #e0e0e0;
        }
        
        .close-button {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #1a237e;
            font-weight: bold;
            padding: 5px;
        }
        
        body.dark-mode .close-button {
            color: #e0e0e0;
        }
        
        .modal h2 {
            color: #1a237e;
            margin-bottom: 20px;
            border-bottom: 2px solid gold;
            padding-bottom: 10px;
            text-align: center;
        }
        
        body.dark-mode .modal h2 {
            color: gold;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #1a237e;
            font-weight: bold;
        }
        
        body.dark-mode .form-group label {
            color: #bb86fc;
        }
        
        .form-group input {
            width: 100%;
            padding: 10px;
            border: 2px solid #1a237e;
            border-radius: 5px;
            font-size: 16px;
        }
        
        body.dark-mode .form-group input {
            background-color: #2d2d2d;
            color: #e0e0e0;
            border-color: #444;
        }
        
        .submit-button {
            background-color: #1a237e;
            color: gold;
            border: none;
            padding: 12px 30px;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
            width: 100%;
            transition: background-color 0.3s;
            font-weight: bold;
        }
        
        .submit-button:hover {
            background-color: #303f9f;
        }
        
        .error-message {
            color: #ff4444;
            margin-top: 10px;
            display: none;
            text-align: center;
        }
        
        body.dark-mode .error-message {
            color: #ff6b6b;
        }
        
        /*   –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç */
        .profile-info {
            background-color: #f8f8f8;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 20px;
            border-left: 4px solid gold;
        }
        
        body.dark-mode .profile-info {
            background-color: #2d2d2d;
        }
        
        .profile-info h3 {
            color: #1a237e;
            margin-bottom: 10px;
            text-align: center;
        }
        
        body.dark-mode .profile-info h3 {
            color: gold;
        }
        
        .profile-info p {
            margin-bottom: 10px;
            padding: 5px 0;
            border-bottom: 1px solid #ddd;
        }
        
        body.dark-mode .profile-info p {
            border-bottom: 1px solid #444;
        }
        
        .logout-button {
            background-color: #d32f2f;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
            width: 100%;
            font-size: 16px;
            font-weight: bold;
            margin-top: 10px;
        }
        
        .logout-button:hover {
            background-color: #b71c1c;
        }
        
        /*  —á–∞—Ç –∏ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è */
        .chat-container {
            max-width: 100%;
            margin: 0 auto;
        }
        
        .chat-header {
            background-color: #1a237e;
            color: gold;
            padding: 15px;
            border-radius: 5px 5px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .chat-messages {
            height: 300px;
            overflow-y: auto;
            background-color: #f5f5f5;
            padding: 20px;
            border-left: 1px solid #ddd;
            border-right: 1px solid #ddd;
        }
        
        body.dark-mode .chat-messages {
            background-color: #2d2d2d;
            border-color: #444;
        }
        
        .message {
            margin-bottom: 15px;
            padding: 10px;
            background-color: white;
            border-radius: 5px;
            border-left: 3px solid #1a237e;
            display: flex;
            gap: 10px;
        }
        
        body.dark-mode .message {
            background-color: #1e1e1e;
            border-left-color: gold;
        }
        
        .message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid #1a237e;
            flex-shrink: 0;
            background-color: #f0f0f0;
        }
        
        body.dark-mode .message-avatar {
            border-color: gold;
            background-color: #2d2d2d;
        }
        
        .message-content-wrapper {
            flex: 1;
        }
        
        .message.system-message {
            background-color: #e3f2fd;
            border-left-color: #2196f3;
            text-align: center;
            font-style: italic;
            display: block;
        }
        
        body.dark-mode .message.system-message {
            background-color: #0d47a1;
            border-left-color: #64b5f6;
        }
        
        .message.encrypted {
            background-color: #f3e5f5;
            border-left-color: #9c27b0;
        }
        
        body.dark-mode .message.encrypted {
            background-color: #4a1c5c;
            border-left-color: #ba68c8;
        }
        
        .message-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }
        
        .message-user {
            font-weight: bold;
            color: #1a237e;
        }
        
        body.dark-mode .message-user {
            color: gold;
        }
        
        .message-time {
            color: #666;
            font-size: 0.9em;
        }
        
        body.dark-mode .message-time {
            color: #aaa;
        }
        
        .message-content {
            line-height: 1.4;
            word-break: break-word;
        }
        
        .encryption-badge {
            font-size: 0.8em;
            color: #9c27b0;
            margin-top: 5px;
            display: inline-block;
        }
        
        .chat-input-container {
            display: flex;
            gap: 10px;
            padding: 15px;
            background-color: #f5f5f5;
            border: 1px solid #ddd;
            border-radius: 0 0 5px 5px;
        }
        
        body.dark-mode .chat-input-container {
            background-color: #2d2d2d;
            border-color: #444;
        }
        
        .chat-input {
            flex: 1;
            padding: 10px;
            border: 2px solid #1a237e;
            border-radius: 5px;
            font-size: 16px;
        }
        
        body.dark-mode .chat-input {
            background-color: #1e1e1e;
            color: #e0e0e0;
            border-color: #444;
        }
        
        .send-button {
            background-color: #1a237e;
            color: gold;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
            font-weight: bold;
        }
        
        .send-button:hover {
            background-color: #303f9f;
        }
        
        .chat-notice {
            text-align: center;
            padding: 20px;
            color: #666;
            font-style: italic;
        }
        
        body.dark-mode .chat-notice {
            color: #aaa;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ */
        .contacts-container {
            display: flex;
            gap: 20px;
            height: 400px;
        }
        
        .contacts-list {
            width: 250px;
            border-right: 2px solid #1a237e;
            overflow-y: auto;
            padding-right: 10px;
        }
        
        .contact-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px;
            margin-bottom: 8px;
            background-color: #f5f5f5;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid transparent;
        }
        
        body.dark-mode .contact-item {
            background-color: #2d2d2d;
        }
        
        .contact-item:hover {
            background-color: #e0e0e0;
            border-color: #1a237e;
        }
        
        body.dark-mode .contact-item:hover {
            background-color: #3d3d3d;
        }
        
        .contact-item.active {
            background-color: #1a237e;
            color: gold;
            border-color: gold;
        }
        
        .contact-item.active .contact-name {
            color: gold;
        }
        
        .contact-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid gold;
            background-color: #f0f0f0;
        }
        
        body.dark-mode .contact-avatar {
            background-color: #2d2d2d;
        }
        
        .contact-info {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .contact-name {
            font-weight: bold;
            color: #1a237e;
        }
        
        body.dark-mode .contact-name {
            color: gold;
        }
        
        .contact-last-message {
            font-size: 0.8em;
            color: #666;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 120px;
        }
        
        body.dark-mode .contact-last-message {
            color: #aaa;
        }
        
        .contact-unread {
            background-color: gold;
            color: #1a237e;
            border-radius: 50%;
            min-width: 22px;
            height: 22px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8em;
            font-weight: bold;
            padding: 0 4px;
        }
        
        .private-chat-area {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .private-chat-header {
            padding: 15px;
            background-color: #f0f0f0;
            border-bottom: 2px solid #1a237e;
            font-weight: bold;
            color: #1a237e;
        }
        
        body.dark-mode .private-chat-header {
            background-color: #2d2d2d;
            color: gold;
        }
        
        .private-messages {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
            background-color: #fafafa;
        }
        
        body.dark-mode .private-messages {
            background-color: #1e1e1e;
        }
        
        .encryption-info {
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 10px 15px;
            color: #1a237e;
            font-size: 0.9em;
            background-color: #f0f0f0;
            border-top: 1px solid #ddd;
        }
        
        body.dark-mode .encryption-info {
            color: gold;
            background-color: #2d2d2d;
            border-color: #444;
        }
        
        /* –ê–≤–∞—Ç–∞—Ä–∫–∏ */
        .avatar-container {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .avatar-preview {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid #1a237e;
            margin: 0 auto 15px;
            display: block;
        }
        
        body.dark-mode .avatar-preview {
            border-color: gold;
        }
        
        .avatar-upload-label {
            display: inline-block;
            background-color: #1a237e;
            color: gold;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
            font-weight: bold;
            margin-top: 10px;
        }
        
        .avatar-upload-label:hover {
            background-color: #303f9f;
        }
        
        .avatar-upload-input {
            display: none;
        }
        
        .change-avatar-button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
            font-weight: bold;
            margin-top: 10px;
        }
        
        .change-avatar-button:hover {
            background-color: #45a049;
        }
        
        .avatar-message {
            margin-top: 10px;
            color: #666;
            font-size: 0.9em;
            text-align: center;
        }
        
        body.dark-mode .avatar-message {
            color: #aaa;
        }
        
        /* –ò–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∑–∞–≥—Ä—É–∑–∫–∏ –∞–≤–∞—Ç–∞—Ä–∫–∏ */
        .avatar-loading {
            opacity: 0.5;
            filter: grayscale(50%);
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—è —Ç–µ–º—ã */
        .theme-switcher {
            background: linear-gradient(90deg, #ffeb3b 0%, #1a237e 100%);
            color: #000;
            text-align: center;
            padding: 10px 0;
            font-weight: bold;
            border-bottom: 2px solid gold;
            cursor: pointer;
            user-select: none;
            transition: all 0.3s ease;
        }
        
        .theme-switcher:hover {
            background: linear-gradient(90deg, #ff9800 0%, #0d153a 100%);
            color: #fff;
        }
        
        .theme-switcher span {
            display: inline-block;
            margin: 0 10px;
            font-size: 1.2rem;
        }
        
        body {
            font-family: 'Times New Roman', serif;
            background-color: #f5f5f5;
            color: #333;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            transition: background-color 0.3s, color 0.3s;
        }
        
        /*  –¢–µ–º–Ω–∞—è —Ç–µ–º–∞ */
        body.dark-mode {
            background-color: #121212;
            color: #e0e0e0;
        }
        
        body.dark-mode .page {
            background-color: #1e1e1e;
            color: #e0e0e0;
            box-shadow: 0 2px 5px rgba(255, 255, 255, 0.1);
        }
        
        body.dark-mode .hero-card {
            background-color: #2d2d2d;
            border-color: #444;
        }
        
        body.dark-mode .citizenship-form {
            background-color: #2d2d2d;
        }
        
        body.dark-mode .contact-list li {
            background-color: #2d2d2d;
        }
        
        body.dark-mode .research-paper h3,
        body.dark-mode .research-paper h4,
        body.dark-mode .research-paper h5 {
            color: #bb86fc;
        }
        
        body.dark-mode .tabs-container {
            border-color: #444;
        }
        
        body.dark-mode .tab-content {
            background-color: #1e1e1e;
        }
        
        body.dark-mode .tab-button {
            background-color: #0d153a;
        }
        
        body.dark-mode .tab-button:hover {
            background-color: #1a237e;
        }
        
        header {
            background-color: #1a237e;
            color: gold;
            text-align: center;
            padding: 1rem 0;
            border-bottom: 5px solid gold;
        }
        
        .header-images {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 10px 0;
            flex-wrap: wrap;
        }
        
        .header-images img {
            max-height: 150px;
            border: 2px solid gold;
            border-radius: 5px;
        }
        
        h1 {
            margin: 0;
            font-size: 3rem;
        }
        
        .container {
            max-width: 800px;
            margin: 2rem auto;
            padding: 0 1rem;
            flex: 1;
        }
        
        .page {
            display: none;
            padding: 2rem;
            background-color: white;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }
        
        .active {
            display: block;
        }
        
        nav {
            background-color: #1a237e;
            padding: 1rem;
            text-align: center;
        }
        
        nav a {
            color: gold;
            text-decoration: none;
            margin: 0 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            transition: background-color 0.3s;
            display: inline-block;
        }
        
        nav a:hover {
            background-color: #303f9f;
        }
        
        footer {
            background-color: #1a237e;
            color: gold;
            text-align: center;
            padding: 1rem 0;
            margin-top: auto;
            width: 100%;
        }
        
        .page-image {
            max-width: 100%;
            display: block;
            margin: 20px auto;
            border: 2px solid #1a237e;
            border-radius: 5px;
        }
        
        .contact-list {
            list-style-type: none;
            padding: 0;
        }
        
        .contact-list li {
            margin-bottom: 1rem;
            padding: 0.5rem;
            background-color: #f8f8f8;
            border-left: 3px solid #1a237e;
        }
        
        .citizenship-form {
            margin-top: 2rem;
            padding: 1rem;
            background-color: #f0f0f0;
            border-radius: 5px;
        }
        
        .citizenship-form ol {
            padding-left: 1.5rem;
        }
        
        .citizenship-form li {
            margin-bottom: 1rem;
        }
        
        .hero-card {
            margin-bottom: 2rem;
            padding: 1.5rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #f9f9f9;
        }
        
        .hero-title {
            color: #1a237e;
            border-bottom: 2px solid gold;
            padding-bottom: 0.5rem;
        }
        
        .hero-subtitle {
            font-style: italic;
            color: #555;
            margin-top: -0.5rem;
            margin-bottom: 1rem;
        }

        /* –°–∏—Å—Ç–µ–º—ã –≤–∫–ª–∞–¥–æ–∫ */
        .tabs-container {
            margin-top: 2rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            overflow: hidden;
        }

        .tabs-header {
            display: flex;
            background-color: #1a237e;
            border-bottom: 2px solid gold;
        }

        .tab-button {
            background-color: transparent;
            color: gold;
            border: none;
            padding: 1rem 1.5rem;
            cursor: pointer;
            font-size: 1rem;
            font-family: 'Times New Roman', serif;
            transition: background-color 0.3s;
            flex: 1;
            text-align: center;
        }

        .tab-button:hover {
            background-color: #303f9f;
        }

        .tab-button.active {
            background-color: #0d153a;
            font-weight: bold;
            border-bottom: 3px solid gold;
        }

        .tab-content {
            display: none;
            padding: 1.5rem;
            background-color: white;
        }

        .tab-content.active {
            display: block;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –Ω–∞—É—á–Ω—ã—Ö —Ä–∞–±–æ—Ç */
        .science-intro {
            margin-bottom: 2rem;
            padding-bottom: 2rem;
            border-bottom: 2px solid #1a237e;
        }

        .research-paper {
            line-height: 1.6;
        }

        .research-paper h3, .research-paper h4, .research-paper h5 {
            color: #1a237e;
            margin-top: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .research-paper h3 {
            border-bottom: 2px solid gold;
            padding-bottom: 0.5rem;
        }

        .research-paper ul {
            padding-left: 2rem;
            margin: 1rem 0;
        }

        .research-paper li {
            margin-bottom: 0.5rem;
        }

        .comparative-images {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin: 1.5rem 0;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –Ω–∞—É–∫–∏ */
        #science .page-image {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 1.5rem auto;
            border: 2px solid #1a237e;
            border-radius: 5px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }
            
            nav a {
                margin: 0.2rem;
                padding: 0.4rem 0.8rem;
                font-size: 0.9rem;
            }
            
            .header-images img {
                max-height: 100px;
            }
            
            .container {
                margin: 1rem auto;
                padding: 0 0.5rem;
            }
            
            .page {
                padding: 1rem;
            }

            .tabs-header {
                flex-direction: column;
            }
            
            .tab-button {
                padding: 0.8rem;
                font-size: 0.9rem;
            }
            
            .tab-content {
                padding: 1rem;
            }
            
            .comparative-images {
                flex-direction: column;
            }
            
            .theme-switcher span {
                margin: 0 5px;
                font-size: 1rem;
            }
            
            .login-button-container,
            .user-menu {
                top: 10px;
                right: 10px;
            }
            
            .login-button,
            .user-button {
                padding: 8px 15px;
                font-size: 14px;
            }
            
            .avatar-preview {
                width: 100px;
                height: 100px;
            }
            
            .message-avatar {
                width: 30px;
                height: 30px;
            }
            
            .contacts-container {
                flex-direction: column;
                height: auto;
            }
            
            .contacts-list {
                width: 100%;
                border-right: none;
                border-bottom: 2px solid #1a237e;
                max-height: 200px;
            }
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∑–≤–æ–Ω–∫–æ–≤ */
        .call-button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            margin-left: 10px;
            transition: background-color 0.3s;
        }
        
        .call-button:hover {
            background-color: #45a049;
        }
        
        .call-button.in-call {
            background-color: #f44336;
        }
        
        .call-button.in-call:hover {
            background-color: #d32f2f;
        }
        
        #callModal .modal-content {
            max-width: 400px;
        }
        
        .call-container {
            text-align: center;
        }
        
        .call-status {
            font-size: 18px;
            margin-bottom: 20px;
            padding: 15px;
            background-color: #f0f0f0;
            border-radius: 5px;
        }
        
        body.dark-mode .call-status {
            background-color: #2d2d2d;
        }
        
        .call-actions {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }
        
        .call-accept {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        
        .call-accept:hover {
            background-color: #45a049;
        }
        
        .call-reject {
            background-color: #f44336;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        
        .call-reject:hover {
            background-color: #d32f2f;
        }
        
        .call-end {
            background-color: #f44336;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        
        .call-end:hover {
            background-color: #d32f2f;
        }
        
        /* –°–∫—Ä—ã–≤–∞–µ–º –≤–∏–¥–µ–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä - –æ–Ω –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–µ–Ω */
        .video-container {
            display: none !important;
        }
    </style>
</head>
<body>
    <!--  –ö–Ω–æ–ø–∫–∞ Log In -->
    <div class="login-button-container" id="loginButtonContainer">
        <button class="login-button" onclick="showLoginModal()">Log In</button>
    </div>
    
    <!--  –ú–µ–Ω—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ—Å–ª–µ —Å–æ–≤–µ—Ä—à–µ–Ω–∏—è –≤—Ö–æ–¥–∞ -->
    <div class="user-menu" id="userMenu">
        <button class="user-button" onclick="toggleUserMenu()">
            <span id="userAvatarIcon">üë§</span>
            <span id="userName">User</span>
        </button>
        <div class="dropdown-menu" id="userDropdown">
            <button onclick="showPersonalCabinet()">
                üë§ Personal Cabinet
            </button>
            <div class="chat-buttons">
                <button onclick="showPublicChat()">
                    üí¨ Live Chat
                </button>
                <button onclick="showPrivateMessages()" id="privateMessagesButton">
                    ‚úâÔ∏è Personal Chats
                    <span class="unread-badge" id="totalUnreadBadge" style="display: none;">0</span>
                </button>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—Ö–æ–¥–∞ -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <button class="close-button" onclick="closeLoginModal()">√ó</button>
            <h2>Imperial Login</h2>
            <form id="loginForm">
                <div class="form-group">
                    <label for="username">Login:</label>
                    <input type="text" id="username" required placeholder="Enter your login">
                </div>
                <div class="form-group">
                    <label for="password">Password:</label>
                    <input type="password" id="password" required placeholder="Enter your password">
                </div>
                <button type="button" class="submit-button" onclick="login()">Enter the Empire</button>
                <div class="error-message" id="loginError">Invalid login or password!</div>
            </form>
        </div>
    </div>
    
    <!--  –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞ -->
    <div class="modal" id="personalCabinetModal">
        <div class="modal-content">
            <button class="close-button" onclick="closePersonalCabinet()">√ó</button>
            <h2>Imperial Personal Cabinet</h2>
            <div id="cabinetContent">
                <!-- –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ -->
            </div>
        </div>
    </div>
    
    <!--  –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ–±—â–µ–≥–æ —á–∞—Ç–∞ -->
    <div class="modal" id="publicChatModal">
        <div class="modal-content">
            <button class="close-button" onclick="closePublicChat()">√ó</button>
            <h2>Imperial Live Chat</h2>
            <div class="chat-container">
                <div class="chat-header">
                    <span>üí¨ Imperial Citizens Public Chat</span>
                    <span id="onlineCount">Online: 0</span>
                </div>
                <div class="chat-messages" id="publicChatMessages">
                    <div class="chat-notice">Welcome to the Imperial Public Chat! All messages are encrypted for security.</div>
                </div>
                <div class="chat-input-container">
                    <input type="text" class="chat-input" id="publicChatInput" placeholder="Type your message..." maxlength="500">
                    <button class="send-button" onclick="sendPublicMessage()">Send</button>
                </div>
                <div class="encryption-info">
                    <span>üîí All messages are encrypted with AES-256 (visible to all citizens)</span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π -->
    <div class="modal" id="privateMessagesModal">
        <div class="modal-content">
            <button class="close-button" onclick="closePrivateMessages()">√ó</button>
            <h2>Personal Chats</h2>
            <div class="contacts-container">
                <div class="contacts-list" id="contactsList">
                    <!-- –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ -->
                </div>
                <div class="private-chat-area">
                    <div class="private-chat-header" id="privateChatHeader">
                        ‚úâÔ∏è Select a citizen to start messaging
                    </div>
                    <div class="private-messages" id="privateMessages">
                        <div class="chat-notice">Choose a citizen from the list to begin a private conversation</div>
                    </div>
                    <div class="chat-input-container">
                        <input type="text" class="chat-input" id="privateChatInput" placeholder="Type your private message..." maxlength="500" disabled>
                        <button class="send-button" id="sendPrivateButton" onclick="sendPrivateMessage()" disabled>Send</button>
                        <button class="call-button" id="callButton" onclick="handleCallButtonClick()" disabled>üé• Call</button>
                    </div>
                    <div class="encryption-info">
                        <span>üîí End-to-end encrypted - only visible to you and the recipient</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∑–≤–æ–Ω–∫–∞ (—Ç–æ–ª—å–∫–æ –∞—É–¥–∏–æ) -->
    <div class="modal" id="callModal">
        <div class="modal-content">
            <button class="close-button" onclick="endCall()">√ó</button>
            <h2 id="callTitle">Imperial Call</h2>
            <div class="call-container">
                <div class="call-status" id="callStatus">Initializing...</div>
                <div class="call-actions" id="callActions">
                    <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è -->
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è -->
    <div class="modal" id="mobileWarningModal">
        <div class="modal-content">
            <button class="close-button" onclick="closeMobileWarning()">√ó</button>
            <h2>Voice Calls</h2>
            <div class="call-container">
                <div class="call-status">
                    Voice calls are only available on desktop devices.
                </div>
                <div class="call-actions">
                    <button class="call-reject" onclick="closeMobileWarning()">OK</button>
                </div>
            </div>
        </div>
    </div>
    
    <header>
        <h1>Sacred Daniel's Empire</h1>
        <div class="header-images">
            <img src="TBA-SITE/1200px-Flag_of_Spain.webp" alt="Imperial Flag">
            <img src="TBA-SITE/20211209_130933.webp" alt="Imperial Symbol">
            <img src="TBA-SITE/5c8d1d84fcd5694f34ec5a7c122609d0.webp" alt="Imperial Emblem">
        </div>
    </header>
    
    <!--  –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–º—ã -->
    <div class="theme-switcher" onclick="toggleTheme()">
        <span>‚òÄÔ∏è</span>
        <span>The Sun Scorching Sinners</span>
        <span>|</span>
        <span>The Night - the Outing of Werewolves</span>
        <span>üåô</span>
    </div>
    
    <nav>
        <a href="#" onclick="showPage('home')">Home</a>
        <a href="#" onclick="showPage('about')">About Us</a>
        <a href="#" onclick="showPage('history')">History</a>
        <a href="#" onclick="showPage('heroes')">Heroes of the Empire</a>
        <a href="#" onclick="showPage('science')">Science of the Empire</a>
        <a href="#" onclick="showPage('codex')">Codex</a>
        <a href="#" onclick="showPage('government')">Government</a>
        <a href="#" onclick="showPage('media')">Media</a>
        <a href="#" onclick="showPage('contact')">Contact</a>
    </nav>
    
    <div class="container">
        <div id="home" class="page active">
            <h2>Welcome to Sacred Daniel's Empire</h2>
            <p>The glorious maritime nation under the wise rule of our sacred Emperor. P.S to be able to log in you need to head to the contact section - then apply for citizenship - then after all the process are done you will receive your ID and data to log in</p>
        </div>
        
        <div id="about" class="page">
            <h2>About Us</h2>
            <p>Sacred Daniel's Empire is a small sovereign state with an absolute monarchy located on the coast, with a strong focus on maritime activities. The country's economy is driven by fishing, trading, shipbuilding, in short - sea is the main reason why this empire is even alive. Its picturesque coastline offers stunning views and opportunities for tourism, attracting visitors from around the world. The culture of the country is deeply rooted in its maritime heritage, with traditional sailing practices and customs celebrated and preserved. Sacred Daniel's Empire is known for its vibrant coastal communities, bustling ports, increased crime rate, wise leaders.</p>
        </div>
        
        <div id="history" class="page">
            <h2>History</h2>
            <img src="TBA-SITE/IMG_20250622_170301.jpg" alt="Historical Document" class="page-image">
            <p>The real location of the empire is unknown but after some skirmishes, myths are saying that its somewhe on South coast of Africa. Empire saved the map of archipelago with its base (black) and fort (red) before leaving it in 1800. Here you can learn the history of the country. <a href="https://docs.google.com/document/d/1iSz32g8wN5WH6trZ8I9tlJhcz8VL54w27zmrCDE2jCM/edit?usp=drivesdk" target="_blank">Read our history document</a></p>
        </div>
        
        <div id="heroes" class="page">
            <h2>Heroes of the Empire</h2>
            
            <div class="hero-card">
                <h3 class="hero-title">Lord Daniel, The First Prophet</h3>
                <p class="hero-subtitle">Titles: The First Daniel, Lord of the Black Angels, Prophet of the Kraken, The Sea-Father</p>
                <p class="hero-subtitle">Era: 1st Century A.D. and beyond (Beginning 33 A.D.)</p>
                <p class="hero-subtitle">Sacred Vessel: The Mini Angel (Originally a Roman Trireme)</p>
                <p class="hero-subtitle">P.S: There are at least 3 Daniels in card. The first one, His son and grandson who later will pronounce empire and himself as an emperor
                    
                <p>Lord Daniel is not merely a historical figure; he is the cornerstone of a nation and a faith. His story begins in the pivotal year 33 A.D., in the immediate, disillusioned aftermath of the Crucifixion of Jesus Christ. Unlike the masses, Daniel did not mourn; he was filled with disgust and fear at the event. This rejection of the established divine order was the catalyst for his destiny.</p>
                
                <p>In an act of supreme defiance, he gathered a band of outcasts: thieves, mercenaries, and runaway slaves, and under cover of darkness, they seized a Roman trireme, slaughtering its crew. This ship, the very next day, would be christened the Mini Angel, the first sacred vessel of a new future empire.</p>
                
                <p>The founding miracle occurred on the second day of their voyage. The sea turned black, and from the depths rose the Kraken, a colossal entity that Daniel interpreted not as a monster, but as a new God. While his crew trembled, Daniel stood firm and received his revelation. He declared to his followers: "There is no God left but the Kraken. And we are his sons and daughters." In that moment, he transformed from a fugitive into a Prophet, establishing the one true faith of his future empire. This direct, divine encounter made him a living saint, the chosen herald of a deity of the deep.</p>
                
                <p>Daniel possessed a transcendent form of leadership. He found a crew of pathetic land-rats ready to betray each other for a piece of stale bread and, through his will and vision, forged them into pirates living by a code of honor, dignity, and respect for women. His early fleet was a unique society. Out of necessity, women were more numerous aboard ships due to the lack of land, participating fully in this new maritime life. It was under Daniel's rule that this disparate band evolved into a disciplined clan, the "Black Angels," who became more than soldiers, they were a family bound by blood and battle.</p>
                
                <p>Daniel's reign was one of relentless expansion and confrontation with the unknown. His voyage to the forbidden Island in 1100 A.D. showcases his courage and the limits of his power. After a brutal, unexplained attack by feral tribesmen who seemed driven by a terror greater than his own crew, Daniel was forced to retreat. His final log entry, "They feared not us. They fled from something else... something in the high valleys," marked one of the rare times the empire chose mystery over conquest, purging the island's coordinates from their charts forever.</p>
                
                <p><strong>The Eternal Rival: Admiral James Norridon</strong></p>
                <p>Daniel's character is further defined by his long-standing conflict with Admiral James Norridon of the Royal Navy. This was not a simple feud but a clash of philosophies. Norridon was a master of disciplined, honorable warfare, while Daniel fought as an unpredictable, ruthless privateer king. Despite the bloodshed, Daniel deeply admired Norridon for his honor and his profound understanding of the sea. Their battles were a "deadly dance" where neither could land a killing blow. In his old age, it is said that Daniel would toast his rival: "To Norridon. May the depths be kinder to him than I ever was." This relationship reveals a complex man who cherished a worthy enemy as a sharpening stone for his own mind and spirit.</p>
                
                <p>Lord Daniel's life laid the foundation for everything that follows: he provided the sacred relic: the Mini Angel, a ship that would be rebuilt over centuries but forever remain the soul of the empire. He founded the state religion: the Cult of the Kraken, which would later be formalized into the militant "Legion of the Squid" order. He established the core principles of honor, brotherhood, and naval supremacy. He instituted the imperial title, ensuring every ruler to follow would bear his name and the title Sacred, forever intertwining the destiny of the emperor with the legendary ship he first stole, and the God he first witnessed.</p>
            </div>
            
            <div class="hero-card">
                <h3 class="hero-title">His Sacred Majesty, Emperor Daniel de Courno</h3>
                <p class="hero-subtitle">Title: Sacred Emperor of the Empire of Sacred Daniel</p>
                <p class="hero-subtitle">Era: 18th Century</p>
                <p class="hero-subtitle">Notable Vessel: The Sacred Mini Angel (Brig and flagman of the empire)</p>
                
                <p><strong>Character Analysis</strong></p>
                <p>Emperor Daniel de Courno was the defining ruler of his age, a sovereign whose intellect and calculated demeanor shaped an era of expansion, reform, and consolidation for his empire. Daniel's most defining trait was his calculating and highly intelligent mind. He was not a man of impulsive action. Every decision, from the smallest decree to the grandest imperial policy, was considered numerous times, and even after a course was chosen, he would continue to ponder its ramifications. This relentless analysis made him a formidable strategist, always several steps ahead of his adversaries and allies alike.</p>
                
                <p>Despite his reserved and thoughtful nature, the Emperor possessed undeniable charisma and an easy ability to make friends. This personal charm was a powerful political tool, allowing him to secure alliances, inspire loyalty in his admirals, and present a compelling figurehead to his people. He was a thinker, but not a recluse.</p>
                
                <p>Unusual for a monarch of his stature, Daniel de Courno was deeply connected to the maritime lifeblood of his empire. He was known to personally take to the seas on his brig, the Sacred Mini Angel, demonstrating a hands-on approach to leadership and a genuine connection to his navy.</p>
                
                <p>His reign was profoundly marked by the Archipelago Campaign (1760-1800), a period of intense activity that saw the empire stumble upon, conquer, and ultimately abandon a strategically vital island chain. The campaign was an era of sweeping reforms, severe reprisals, and significant military victories. Under Daniel's direction, the empire aggressively developed the archipelago, funneling massive quantities of resources back to the Capital to fuel its growth.</p>
                
                <p>A key strategic victory, unrelated to battle, was the alliance with the Scots (1765-1800). Emperor Daniel immediately recognized the opportunity presented by the lost Scottish fleet. With shrewd foresight, he swiftly extended an offer of alliance, transforming a potential threat into a "powerful, temporary navy." This three-decade-long pact, built on mutual necessity and a "grudging respect," secured imperial dominance over the islands and showcased Daniel's talent for strategic partnership.</p>
                
                <p>The campaign's military climax was the decisive annihilation of the Dublin Fleet in 1798. While commanded by the legendary Admiral Bharath, the victory was a direct result of the imperial war machine Daniel had built and the alliances he had fostered, exemplified by the last-minute arrival of their loyal "rogue schooner."</p>
                
                <p>In a final act of strategic calculation that defined his entire reign, history records that the Empire made the strategic decision to abandon the archipelago in 1800 to pursue greater ambitions elsewhere.</p>
            </div>
            
            <div class="hero-card">
                <h3 class="hero-title">Arthur Bha ‚Äì The Emperor's High Advisor</h3>
                <p class="hero-subtitle">Titles: Imperial Advisor, Keeper of the Archives</p>
                <p class="hero-subtitle">Affiliation: The Imperial House of Sacred Daniel</p>
                <p class="hero-subtitle">Known For: Unconventional intelligence gathering, profound loyalty, and a life lived in many guises</p>
                
                <p>Arthur Bha was the quintessential man of contrasts. Officially, he was the emperor's highest advisor, a figure most at home in the dim light of the imperial archives, surrounded by the secrets and laws of the realm. He was a scholar and a diplomat, the meticulous hand that recorded history and guided the emperor with a quiet, reasoned voice.</p>
                
                <p>Yet, the palace walls could not contain him. When the weight of duty became stifling, Arthur would vanish. He was not a man who traveled on a personal ship with fanfare; instead, he was a master of infiltration. He would disguise himself as a common traveler, joining merchant crews, pirate bands, or even buying tickets on noble transports. This was not for leisure, but a deeper need to understand the empire from the ground up.</p>
                
                <p>His journeys were far from passive. Arthur Bha was a man of direct and often dangerous action: he walked foreign roads, listening to stories and subtly convincing worthy individuals to seek citizenship in the empire, strengthening its fabric from the outside in; utilizing the combat skills honed during his six years of mandatory military service, he took up bounty hunting, his sword proving deadly against deserters and outlaws; on the far frontiers, he transformed into a gatherer and hunter, foraging for rare plants like cotton shrubs and medicinal herbs while simultaneously tracking wanted criminals. This dual pursuit earned him independent wealth and renown.</p>
                
                <p>His very name, Bha, was adopted in honor of Admiral Bharath, a figure he deeply admired. This was not an empty gesture. Within the empire, Arthur became the silent guardian of the Admiral's legacy, personally ensuring that Bharath's innovative machines‚Äîthe pulleys, pumps, and other contraptions‚Äîremained in working order. He studied, repaired, and defended their necessity against those who saw them as mere relics.</p>
                
                <p>Arthur Bha defied simple categorization. To the world, he was a diplomat, a scholar, a bounty hunter, and a botanist‚Äîall separate faces of a multifaceted life. But to the emperor, he was simply Arthur Bha‚Äîthe man who recorded history, guarded its truths, and, when needed, rewrote fate itself with a blade or a pen. He was the unseen thread that connected the throne to the world, a loyalist who served not from a dusty chamber, but from the bustling decks and dusty roads of the realm itself. Though his name may not echo in war songs, the empire would not have endured without its quiet, most capable shadow.</p>
            </div>
            
            <div class="hero-card">
                <h3 class="hero-title">Admiral Bharath ‚Äì The Stubborn Architect of the Empire</h3>
                <p class="hero-subtitle">Titles: Admiral of the Imperial Navy, The Cook-Admiral, The Mad Scientist, Emperor (1850-1855)</p>
                <p class="hero-subtitle">Era: Mid-to-Late 19th Century</p>
                <p class="hero-subtitle">Known For: Naval brilliance, technological innovation, and an unprecedented rise from cabin boy to Emperor</p>
                
                <p>Admiral Bharath's career is a testament to sheer, unyielding stubbornness and latent genius. His story began as a scrawny, orphaned boy on the docks of Volney, spotted by Captains Patih and Joe. They brought him aboard the Sacred Mini Angel, the flagship of Emperor Daniel himself. Unlike any other sailor, Bharath's ambition was not for command but for the ship. He became the ship's cook, a brilliant one and refused promotions for years. His legendary meals were a cornerstone of crew morale. This genuine love for cooking later manifested in him opening a tavern and a dining house in the capital, establishing his deep connection to the common sailors long before he led them.</p>
                
                <p>When fate and his own relentless mind pushed him into command, Bharath revealed his true genius: he was a master of diplomacy and psychological warfare. His most legendary move during the Archipelago Campaign was the bloodless capture of six islands from a rival fleet (likely French), without spending a single grain of gunpowder. This event perfectly encapsulates his strategic philosophy. While capable of overwhelming force, he preferred to outthink his opponents, using his skills to make the enemy lower their flags and surrender without a fight. He proved that the empire's greatest expansion could be achieved not just through cannon fire, but through unparalleled cunning.</p>
                
                <p>Bharath's mind was never confined to naval tactics. He was a genius inventor and a restless engineer, constantly seeing problems and designing solutions. He was the driving force behind the empire's technological advancement, constantly arguing with the traditionalist Emperor Daniel about the need for improvement. He designed pulley systems for faster cargo loading, hydraulic pumps, and primitive telegraphs. His workshops were chaotic, but his ideas worked. This created a unique cultural divide in the empire: Bharath's innovations revolutionized the navy and infrastructure, while the Imperial household clung to tradition, a testament to his stubborn but effective push for progress.</p>
                
                <p>Bharath's brilliance made him powerful enemies who orchestrated a vicious smear campaign against him. His salvation came from the very top: Emperor Daniel and his enigmatic friend, Lonee, personally started a rescue mission to extract Bharath and dismantle the conspiracy, proving the immense trust and value Daniel placed in him.</p>
                
                <p>This trust was echoed by the entire military. When Emperor Daniel later succumbed to an unknown illness (likely tuberculosis), the empire faced a succession crisis. In a testament to his universal respect, Admiral Bharath was chosen as the new ruler by the unanimous support of the army and the elite imperial guard, The Black Angels (TBA).</p>
                
                <p>His reign (1850-1855) was that of a military man struggling with governance. Recognizing his own limitations in politics, he made the startlingly humble decision to abdicate in 1855, prioritizing the empire's stability over his own power.</p>
                
                <p>He remains a symbol that true talent and stubborn determination cannot be contained, whether in a ship's galley, on the admiral's bridge, or even on the imperial throne.</p>
            </div>
            
            <div class="hero-card">
                <h3 class="hero-title">Lord Def ‚Äì The Zealous Heart</h3>
                <p class="hero-subtitle">Titles: Lord, Captain, City-Builder, High Inquisitor of the Legion of the Squid</p>
                <p class="hero-subtitle">Era: 17th-18th Centuries</p>
                <p class="hero-subtitle">Known For: A profound transformation from a charismatic nobleman to a fanatical zealot, driven by a core of innate kindness and formidable intellect</p>
                
                <p>Lord Def's life is a story of radical transformation, a journey where his core traits of kindness, responsiveness, and incredible intelligence were refined and redirected through extraordinary experiences.</p>
                
                <p>In his youth, he was the epitome of nobility, known for his charm and love for high society. He was a frequent guest at the philharmonic and every prestigious ball, and his sharp mind found a dangerous outlet in a passion for gambling. However, this was not the recklessness of a fool, but the calculated risk-taking of a brilliant man seeking stimulation.</p>
                
                <p>Beneath the surface of the gambler and socialite lay Def's true nature: he was fundamentally kind, responsive, and possessed of a formidable intellect. These were not traits he acquired, but ones that defined his every action. This innate goodness manifested in his role as a patient teacher, where he led merchant convoys not through intimidation, but by schooling raw recruits in seamanship through discipline and skill.</p>
                
                <p>His intelligence was both creative and strategic. He was a visionary builder who designed and overseen the construction of an entire fortified city called Fort Green, demonstrating not only architectural genius but also the foresight to terraform the land for sustainable agriculture. His mind was capable of grand designs, both for stone and for society.</p>
                
                <p>Def was a man who could seamlessly transition from the drawing room to the battlefield. He was courageous and hands-on, personally dueling one of the empire's most wanted assassins and throwing him into a dungeon. Yet, he also possessed a profound, almost spiritual need for solitude, finding peace in the unlikeliest of places: fishing in the heart of the treacherous Dark Sea, a testament to his unshakable calm and unique daring.</p>
                
                <p>In his later years, the same intensity that once drove him to gambling and city-building found a new, ultimate focus: religious fervor. He went completely to the Legion of the Squid. His kindness curdled into a brutal, unwavering fanaticism. His innate responsiveness became an intrusive need to police faith. His brilliant intellect was now a weapon for theological argument and the orchestration of purges. He ascended to the rank of high inquisitor, preaching the Kraken's will with fire and steel. The man who once built a city to sustain life now dedicated himself to reshaping souls through holy war.</p>
                
                <p>Lord Def is a tragic and compelling figure. He was not a man who changed his nature, but one whose profound inner qualities‚Äîhis goodness, his sharp mind, his capacity for deep focus‚Äîwere twisted and amplified by his experiences and his faith. His journey from the glittering ballrooms to the grim chambers of the inquisition is the story of a great soul seeking purpose, ultimately finding it in the service of a dark and demanding god. He remains the empire's most complex zealot: a man who built and nurtured, only to become its most relentless purifier.</p>
            </div>
        </div>
        
        <div id="science" class="page">
            <h2>Imperial Science</h2>
            
            <!-- –û—Å–Ω–æ–≤–Ω–æ–π —Ç–µ–∫—Å—Ç –æ–± –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º —Ü–µ–Ω—Ç—Ä–µ -->
            <div class="science-intro">
                <h3>The Prophet Daniel Marine Life Research Center</h3>
                <p><strong>Founded in 1876</strong></p>
                <p><strong>Director:</strong> Pairo.P, citizen, high musketeer rank in the military.</p>
                <p><strong>Notable Affiliation:</strong> serves as the primary field research arm for the State Scientific Institute of the lord Def, specifically for its Department of Biology and Ecology.</p>
                
                <p>Established in 1876, the Prophet Daniel Marine Life Research Center was envisioned as the Empire's first dedicated institution for the systematic study of oceanic fauna. Its founding director, the esteemed citizen Pairo.P, brought a unique blend of military discipline and scholarly curiosity to the role, ensuring expeditions were both meticulously organized and daring in scope.</p>
                
                <h4>The Foundational Expedition is the 1884 Octopus Study.</h4>
                <p>The Center's first major published work, dated July 3, 1884, was a landmark study titled "A Comparative Analysis of Octopus Specimens from the Indian Ocean and the Dark Sea." This expedition set the standard for the Center's methodology. The research vessel, an expeditionary ketch, departed from the Capital and sailed to a known octopus habitat in the Indian Ocean. After completing initial observations and securing a live specimen, the ketch set sail for Fort Green, a crucial resupply point, before embarking on the perilous leg of the journey into the Dark Sea. The findings, meticulously recorded by Director Pairo.P, were revolutionary. He documented the colossal size of Dark Sea octopuses compared to their Indian Ocean counterparts, alongside a markedly heightened aggression directed specifically at ships. The expedition's log noted that the crew was forced to navigate around entire islands to approach the calmer specimens, highlighting the extreme behavioral adaptation of the local fauna.</p>
                <p>This seminal 1884 paper provided the foundational data for subsequent research at the Def Institute's Department of Biology and Ecology. It established a critical comparative framework, pointing to a phenomenon later termed the "Dark Sea Anomaly."</p>
                <p>Professor Vladislav.V of the Department of Biology and Ecology expanded upon this work in his treatise "Cartilaginous Fishes" Studying species like striped and ribbon sharks, as well as eagle rays, he confirmed a pattern: multiple, phylogenetically distinct species within the Dark Sea exhibited not only increased physical dimensions but also severe behavioral aberrations.</p>
                <p>In a groundbreaking interdisciplinary hypothesis, Professor Vladislav.V proposed that the anomaly was not taxon-specific but environmental. He noted that the erratic, violent behavior of Dark Sea fauna bore a disturbing resemblance to the psychological profile of a madman as described in Lord Def's theological work, "Heretics as Madmen." This provocative comparison suggested that the same unknown forces that warped the minds of men might also be affecting the very instincts of its marine life, framing the Dark Sea as a zone of profound physiological and psychological distortion.</p>
                
                <!-- –û—Å–Ω–æ–≤–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ -->
                <img src="TBA-SITE/Screenshot_2025-12-22-16-21-48-982_com.android.chrome-edit.jpg" alt="Prophet Daniel Marine Life Research Center" class="page-image">
            </div>
            
            <!-- –°–∏—Å—Ç–µ–º–∞ –≤–∫–ª–∞–¥–æ–∫ –¥–ª—è –Ω–∞—É—á–Ω—ã—Ö —Ä–∞–±–æ—Ç -->
            <div class="tabs-container">
                <div class="tabs-header">
                    <button class="tab-button active" onclick="openTab(event, 'tab1')">1884: Giant Cephalopod Study</button>
                    <button class="tab-button" onclick="openTab(event, 'tab2')">1888: Cartilaginous Fishes</button>
                </div>
                
                <!-- –í–∫–ª–∞–¥–∫–∞ 1: –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –≥–æ–ª–æ–≤–æ–Ω–æ–≥–∏—Ö -->
                <div id="tab1" class="tab-content active">
                    <div class="research-paper">
                        <h3>Comparative Analysis of Giant Cephalopod Morphology and Ethology. The Dark Sea Anomaly</h3>
                        <p><strong>Author:</strong> Pairo.P, director of the Prophet Daniel Marine Life Research Center.</p>
                        <p><strong>Field Expedition Log:</strong> voyage of the Emperor's Book, Expeditionary Ketch.</p>
                        <p><strong>Publication Date:</strong> July 3, 1884.</p>
                        <p><strong>Subject Species:</strong> octopus vulgaris (Indian Ocean variant) & octopus horridus (proposed nomenclature for Dark Sea variant).</p>
                        
                        <h4>I. Expedition Overview & Methodology</h4>
                        <h5>Phase 1: Indian Ocean baseline (April-May 1884)</h5>
                        <p>The Emperor's Book embarked from the Capital, setting course for the coral atolls northeast of Madagascar, a documented habitat for large benthic octopuses. Using baited traps, the team successfully observed and measured seven (7) specimens.</p>
                        <p><strong>Specimen Acquisition:</strong> one mature male, measuring 1.32 meters in total arm span, was carefully sedated using a tincture of opium and belladonna administered via a modified harpoon syringe. It was housed in a specially constructed, constantly circulated seawater tank on the aft deck.</p>
                        <p><strong>Initial Findings (Indian Ocean).</strong></p>
                        <ul>
                            <li>Average Arm Span: 1.3 meters (range: 1.1m - 1.5m).</li>
                            <li>Behavior: cryptic, primarily nocturnal. Exhibited standard escape responses (ink expulsion, jet propulsion, camouflage). Minimal interest in the ship's hull beyond using it for occasional shelter. Reactions to submersed lights were curious but non-aggressive.</li>
                            <li>Coloration: typical dynamic camouflage; patterns correlated with substrate, not emotional state beyond baseline alertness.</li>
                        </ul>
                        
                        <h5>Phase 2: Transit & Resupply</h5>
                        <p>The Emperor's Book sailed to Fort Green, delivering initial reports and taking on reinforced equipment: thicker-gauge steel cables, heavier winches, and fortified specimen containment units, based on preliminary data telegrams.</p>
                        
                        <h5>Phase 3: the Dark Sea Incursion (June 1884).</h5>
                        <p>Entering the perpetual overcast of the Dark Sea, the expedition faced immediate challenges of weather.</p>
                        
                        <h4>II. Dark Sea Encounter & Radical Adaptations.</h4>
                        <p>The first visual confirmation occurred on June 12th. What was initially charted as a small, rocky islet approximately 200 meters off the starboard bow was, in fact, a colossal octopus resting in the shallows. Its true nature was revealed when the "island" shifted, and a gargantuan eye, the size of a ship's wheel, broke the surface.</p>
                        
                        <p><strong>Field Measurements & Observations.</strong></p>
                        <ul>
                            <li><strong>Size:</strong> the team managed to map three individuals from a distance using triangulation. Arm spans were consistently measured between 18 to 22 meters. The smallest confirmed specimen was 19.5 meters.</li>
                            <li><strong>Aggression Protocol:</strong> the standard research approach proved impossible. Lowering a submersible or divers was deemed suicidal. The octopuses displayed active, targeted aggression.</li>
                            <li>They would deliberately surface between the ship and its intended anchorage, a behavior never observed in any other cephalopod. On two occasions, individuals used their arms to hurl boulders (estimated 200-300 kg) in the general direction of the ship's hull. This was not feeding behavior; it was territorial bombardment. Their chromatophores did not just mimic surroundings. They flashed violent, pulsating patterns of deep crimson and black.</li>
                        </ul>
                        
                        <p><strong>Specimen Acquisition (Dark Sea).</strong></p>
                        <p>After eight days of failed approaches, Director Pairo.P ordered the Emperor's Book to sail a full 15 nautical miles around a volcanic ridge. In the lee of the ridge, in a deep, silt-filled basin, they located a single, slightly smaller specimen (approximately 17 meters) that exhibited marginally less immediate hostility. Using a launch, they deployed a fortified net of chain-link and tarred rope, baited with a entire side of salted beef. The creature was ensnared. The struggle was titanic. It took three hours and nearly parted the Emperor's Book's main winch cable before the beast was subdued via a massive dose of sedative (ten times the Indian Ocean dosage). It was secured against the ship's hull in a reinforced nylon and chain mesh sling, its immense weight causing a notable list.</p>
                        
                        <!-- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –≤–∫–ª–∞–¥–∫–∏ 1 -->
                        <img src="TBA-SITE/Screenshot_2025-12-22-15-38-47-086_com.android.chrome-edit.jpg" alt="Dark Sea Octopus Specimen Acquisition" class="page-image">
                        
                        <h4>Director Pairo.P's Conclusion.</h4>
                        <p>The creature we have termed as "octopus horridus" is not merely a larger version of its global cousins. It is a fundamentally different ecological entity. The scale of gigantism (a ~1500% increase in linear dimensions) defies all known models of deep-sea gigantism, which typically favor cooler, stable environments, not the volatile, storm-wracked Dark Sea.</p>
                        <p>More alarming than its size is its behavioral pathology. It does not view our ships as neutral objects or potential predators, but as rivals or prey. Its actions are calculated, persistent, and shockingly weaponized. The parallel to the deranged, fixated aggression described in certain theological texts on madness is unsettling and warrants further interdisciplinary investigation.</p>
                        <p>This expedition posits a terrifying hypothesis that the Dark Sea is not just a geographic location, but a transformative biosphere. It exerts a pressure that perverts the natural order, creating not just giants, but monsters. Our understanding of marine biology must now account for an environment that breeds insanity in the flesh.</p>
                    </div>
                </div>
                
                <!-- –í–∫–ª–∞–¥–∫–∞ 2: –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Ö—Ä—è—â–µ–≤—ã—Ö —Ä—ã–± -->
                <div id="tab2" class="tab-content">
                    <div class="research-paper">
                        <h3>Cartilaginous Fishes of the Southern Seas.</h3>
                        <h4>Section: the Dark Sea Anomaly.</h4>
                        <p><strong>Author:</strong> professor Vladislav.V, Department of Biology and Ecology, lord Def's State Scientific Institute.</p>
                        <p><strong>Field data provided by expedition brig "Shark", Prophet Daniel Marine Life Research Center.</strong></p>
                        <p><strong>Publication Year:</strong> 1888.</p>
                        
                        <h4>1. Introduction and Methodological Note.</h4>
                        <p>This study expands upon the foundational work of the Prophet Daniel Center (Pairo.P, 1884) by applying its comparative framework to cartilaginous fishes, specifically the striped shark (Triakis scyllium) and the ribbon shark (Eridacnis radcliffei). The primary objective was to determine if the morphological and behavioral anomalies observed in cephalopods represent a basin-wide phenomenon. The research was conducted aboard the specially commissioned expedition brig "Shark" which conducted parallel trawling and observational operations in established habitats within the Indian Ocean and the perilous waters of the Dark Sea. All handling protocols were reinforced following the 1884 findings, utilizing hardened steel cages and external observation platforms.</p>
                        <p>A critical theoretical lens for this analysis is drawn from the theological and psychological work of High Inquisitor Def, "Heretics as Madmen" (Def, 1742). Def posits that heresy is not mere doctrinal error but a form of spiritual insanity characterized by "a rupture with natural order, an excessive growth of base passions, and a directed, irrational hostility towards the structures of sacred authority." This framework provides a provocative analogy for interpreting the observed biotic deviations.</p>
                        
                        <h4>2. Comparative Data & Findings.</h4>
                        <!-- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü –¥–ª—è –≤–∫–ª–∞–¥–∫–∏ 2 -->
                        <div class="comparative-images">
                            <img src="TBA-SITE/Screenshot_2025-12-22-16-13-57-947_com.android.chrome-edit.jpg" alt="Comparative Data Table 1" class="page-image">
                            <img src="TBA-SITE/Screenshot_2025-12-22-16-14-43-995_com.android.chrome-edit.jpg" alt="Comparative Data Table 2" class="page-image">
                        </div>
                        
                        <h4>3. Discussion & Conclusion.</h4>
                        <p>The data confirm the "Dark Sea Anomaly" as a pervasive ecological syndrome affecting phylogenetically distant taxa. The observed deviations are not random but follow a disturbing pattern: gigantism, physiological corruption (bioluminescence, hue shift), and radical behavioral inversion towards directed aggression or obsession with human maritime activity.</p>
                        <p>Professor Vladislav's central hypothesis is that these changes are not merely adaptive but pathological. The behavior of the Dark Sea sharks, their purposeless ramming of hulls, mobbing of gear, consumption of wreckage lacks rational predatory or survival logic. It mirrors, in the animal realm, the "directed, irrational hostility" that High Inquisitor Def attributes to the heretic whose mind has been unmoored from divine and natural law (Def, 1742, Ch. 3). The "rupture with natural order" is evident in the inverted day/night cycles and depth preferences.</p>
                        <p><strong>Conclusion:</strong> the environment of the Dark Sea acts as a corrupting agent, producing what can be termed "zoological heresy" a state where creatures exceed their natural bounds in size and form while their instincts become skewed towards a frenzied, seemingly purposeless conflict with the symbols of order and exploration (ships). Further study is imperative, not only for marine biology but also for understanding the metaphysical contours of this region.</p>
                        <p><strong>Cited Work:</strong> Def, High Inquisitor. (1742). Heretics as Madmen. Legion of the Squid Press.</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="codex" class="page">
            <h2>Our Codex</h2>
            <p>Our country follow only one codex which describes all the matter things. <a href="https://docs.google.com/document/d/1qPyRhbWn7Z0yEtAarzPgJIiCiyuVShJeIUF90LDkKAY/edit?usp=drivesdk" target="_blank">Read the Codex</a></p>
        </div>
        
        <div id="government" class="page">
            <h2>Government</h2>
            <img src="TBA-SITE/image.webp" alt="Military Order" class="page-image">
            <p>Our country is ruled by our sacred Emperor and our lovely religious-military order which has its own articles on the second part of the codex. <a href="https://docs.google.com/document/d/1jPr4N3k1AJTX8z73flbp39JR_ew-Jv3yZWvA5O3-N00/edit?usp=drivesdk" target="_blank">Learn about our government</a></p>
        </div>
        
        <div id="media" class="page">
            <h2>Media</h2>
            <p>Current news is published personally by the imperial house, and accordingly if you have reliable information that can attract the empire, send it to the mail forgamesandstuff2006@gmail.com</p>
            
            <!-- –°–∏—Å—Ç–µ–º–∞ –≤–∫–ª–∞–¥–æ–∫ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –º–µ–¥–∏–∞ -->
            <div class="tabs-container">
                <div class="tabs-header">
                    <button class="tab-button active" onclick="openMediaTab(event, 'mediaNews')">Imperial News</button>
                    <button class="tab-button" onclick="openMediaTab(event, 'mediaCriminology')">Criminology & Forensic Psychology</button>
                </div>
                
                <!-- –í–∫–ª–∞–¥–∫–∞ 1: –ù–æ–≤–æ—Å—Ç–∏ -->
                <div id="mediaNews" class="tab-content active">
                    <h3>Imperial News Bulletin</h3>
                    <p>All official announcements, decrees, and news of state importance are published here by the Imperial Chancellery.</p>
                    <div class="hero-card">
                        <h4>Latest Announcement</h4>
                        <p><strong>Date:</strong> Current</p>
                        <p>The Empire continues its maritime research expeditions in the Dark Sea region.</p>
                        <p>Current emperor is fighting his own demons and lucky for him pretty succesful. Wish him luck.</p>
                    </div>
                    <p>For submission of news or important information, contact: forgamesandstuff2006@gmail.com</p>
                </div>
                
                <!-- –í–∫–ª–∞–¥–∫–∞ 2: –ö—Ä–∏–º–∏–Ω–∞–ª–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Å—Ç–∞—Ç—å—è -->
                <div id="mediaCriminology" class="tab-content">
                    <div class="research-paper">
                        <h3>State Imperial University - Department of Criminology & Forensic Psychology</h3>
                        <p><strong>Publication Date:</strong> November 15, 1930</p>
                        <p><strong>Title:</strong> Homo Necans Nobilis</p>
                        <p><strong>Authors:</strong> Dr. Ron.B, Professor of Criminal Anthropology (pseudonym: Rombie). Research Assistant: Max.S, M.Sc. in Forensic Documentation</p>
                        
                        <h4>Abstract</h4>
                        <p>This seminal work challenges the entrenched socio-legal axiom of inherent noble virtue. Through a meticulous, two-decade post-conviction analysis of the case of "Simon [last name redacted]," an aristocratic serial murderer active from 1845-1900, we establish a forensic framework for the "noble predator." The study dissects the offender's pathology, modus operandi, and the profound institutional blindness that facilitated his fifty-five-year campaign. It argues that privilege constructs not just a social barrier but a potent psychological camouflage, enabling pathologies to fester unseen.</p>
                        
                        <h4>I. Introduction</h4>
                        <p>For centuries, Imperial jurisprudence and social doctrine have been underpinned by a tacit, yet powerful, presumption that blue blood inoculates against the basest criminal impulses. The nobleman, as pillar and patron of the state, was viewed through a lens of chivalric ideal and paternalistic duty. Crimes among the aristocracy were treated as affairs of honor, financial malfeasance, or political intrigue and never as the violent, atavistic predation common to the lower orders. This work, leveraging the unprecedented access to the closed case files of one of the Empire's most protracted and horrifying serial murder sprees, seeks to dismantle this fiction. We posit the existence of "Homo Necans Nobilis" - the noble killer.</p>
                        <p>The case of the individual we will refer to as "Subject S." or, colloquially, the "Torden Street Butcher," provides a clinical rosetta stone. His confirmed activity spans fifty-five years (1845-1900), with a victimology that evolved in chilling symmetry with his own perceived invulnerability.</p>
                        
                        <h4>II. Pathology and Progression</h4>
                        <p>Subject S.'s criminal career displays a clear, diagnostically significant progression, challenging the notion of impulsive noble vice.</p>
                        
                        <h5>Phase 1 (c. 1845-1855)</h5>
                        <p>The initial decade of his activity targeted his own social circle: ten noble victims, both male and female. This phase suggests a deep-seated, intimate rage directed at the very fabric of his world. The murders were likely facilitated by access, trust, and the absolute lack of suspicion directed towards a peer. The removal of specific organs (kidney, lung) from these early victims, while grotesque, indicates a ritualistic or symbolic component beyond mere trophy-taking‚Äîa perverted consumption of the essence of his own class.</p>
                        
                        <h5>Phase 2 (c. 1855-1900)</h5>
                        <p>With his appetites whetted and confidence fortified by undetected success, Subject S. expanded his hunting grounds. He moved to the West District, specifically Torden's Street, targeting four merchants and two workers. The methods remained consistent, blending genteel weaponry (sabre, revolver) with brutal, hands-on violence (hunting knife, manual strangulation), illustrating a fusion of aristocratic and savage traits.</p>
                        
                        <h5>Phase 3 (1909)</h5>
                        <p>His final known acts, the murder of two peasants at the city's edge, represent either a reversion to a perceived easier target or a symbolic completion of a cycle that began with the high-born and ended with the lowly. The official count stands at eighteen, with strong evidence for fifteen additional rural victims. Subject S. himself, in his few coherent statements, claimed fifty, a number that, given the time frame and his mobility, is tragically plausible.</p>
                        
                        <h4>III. The Mechanics of Invisibility</h4>
                        <p>Subject S.'s longevity is the most damning indictment of pre-1910 investigative protocols. His nobility granted him three critical shields:</p>
                        
                        <ol>
                            <li><strong>Spatial Immunity:</strong> His movements between city residences, country estates, and hunting lodges were unremarkable, providing natural dispersal and concealment.</li>
                            <li><strong>Procedural Immunity:</strong> Pre-1910, questioning a nobleman required labyrinthine permissions. A patrol could not simply detain a noble one for questioning based on circumstance or proximity. This created de facto safe zones around him.</li>
                            <li><strong>Psychological Immunity:</strong> Local constabularies investigating the death of a merchant on Torden Street would never compile a list of suspects including visiting aristocrats. The gaze of authority stopped at the class barrier.</li>
                        </ol>
                        
                        <p>His capture on August 21, 1910, was itself a product of fortuitous mundanity. He was apprehended not by a brilliant detective, but by a routine patrol, as he prepared to attack a night-shift cleaner at the Def State Scientific Institute.</p>
                        
                        <h4>IV. Trial and Legacy</h4>
                        <p>The trial was a spectacle of legal dissonance. The initial sentence, confinement aboard a penal fishing vessel pending execution reflected the horror of his crimes. However, the intervention of state advocate named Eugene Novikov proved transformative. Novikov successfully framed Subject S. not as a calculating criminal, but as a profoundly disordered individual, his cannibalistic rituals and grandiose claims of fifty victims painted as symptoms of a shattered mind. The court, perhaps unwilling to officially hang a nobleman for such bestial acts, accepted this framing. One month later, the case was closed, and Subject S. (or Simon) was permanently committed to a state psychiatric hospital.</p>
                        
                        <p>From this conclusion, progress was born. The sheer, systemic failure exposed by the case led to the 1910 Imperial Judicial Reform. In 1910, Sacred Emperor Daniel promulgated the Decree on Noble Inquiry that stripped away the procedural immunity, allowing appointed investigators to question nobility of any rank without prior permission (excluding the Imperial family itself). Crucially, it balanced this new power with a prohibition on torture to extract confessions.</p>
                        
                        <div class="hero-card">
                            <h5>Conclusion</h5>
                            <p>The case of Subject S. stands as a permanent monument to the dangers of class-based presumptions in law enforcement. It demonstrates that pathology respects no social station and that privilege can serve as the perfect breeding ground for monstrosity when left unchecked by proper investigative scrutiny. The 1910 reforms represent the Empire's acknowledgment of this truth and its commitment to justice that sees beyond the trappings of nobility.</p>
                            <p><em>Published with permission from the Imperial Archives, Case File #4472-A ("Torden Street Butcher").</em></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="contact" class="page">
            <h2>Empire contacts</h2>
            
            <ul class="contact-list">
                <li><strong>Holy Emperor Daniel De Courno</strong><br>Contact methods: Discord - senioreugene</li>
                <li><strong>High Advisor to the Emperor Arthur Bha</strong><br>Discord - arthurbha</li>
                <li><strong>Heir to the throne and Daniel's son, Einar De Courno (skald)</strong><br>Contact is not possible at the moment, only for citizens.</li>
            </ul>
            
            <div class="citizenship-form">
                <h3>Citizenship</h3>
                <p>To obtain citizenship, write to this email: forgamesandstuff2006@gmail.com using the following form:</p>
                <ol>
                    <li>Your first and last name (you can choose completely different ones than in your previous country, but you are obliged to live by your chosen first and last name for the rest of your life in the empire).</li>
                    <li>Your email for communication (the empire has other ways to communicate between citizens, email is for extremely important news).</li>
                    <li>Are you ready to take an oath of allegiance to the society of freedom and honor? A "yes" answer is sufficient at this stage.</li>
                    <li>Indicate here whether you will be able to apply for a passport that you will receive with dignity? (Print it out, protect it from possible damage). If you are unable to obtain a passport from ready-made materials yourself, contact the emperor asking him to send it to you (this operation may take more time).</li>
                    <li>Tell us about yourself (who you are in this life, how you look at life, maybe you have goals in this life, your date of birth, your previous army experience, your class in society or your ancestors class, your detailed look - send us your picture or the drawing of yourself, strictly yourself, its gonna be used nowhere but in your passport which is available only for you).</li>
                </ol>
            </div>
        </div>
    </div>
    
    <footer>
        &copy; 1700 Sacred Daniel's Empire. All rights reserved.
    </footer>
    
    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Firebase –∏–ª–∏ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ Storage
        const firebaseConfig = {
            apiKey: "AIzaSyCOXWodWpE4KdEW1zwryydQUjfxHPiS-3E",
            authDomain: "sacred-empire-chat.firebaseapp.com",
            databaseURL: "https://sacred-empire-chat-default-rtdb.firebaseio.com",
            projectId: "sacred-empire-chat",
            storageBucket: "sacred-empire-chat.firebasestorage.app",
            messagingSenderId: "131630929373",
            appId: "1:131630929373:web:d4208575c65f0df4525234"
        };
        
        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ Firebase
        let firebaseApp;
        let database;
        let publicChatRef;
        let privateMessagesRef;
        let avatarsRef;
        let callsRef;
        let isFirebaseConnected = false;
        
        // –ö—ç—à –¥–ª—è –∞–≤–∞—Ç–∞—Ä–æ–∫
        let avatarCache = {};
        
        // –ö–ª—é—á —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ —á–∞—Ç–∞ –æ–±—â–∏–π –¥–ª—è –≤—Å–µ—Ö
        const PUBLIC_ENCRYPTION_KEY = "public_empire_chat_key_1700";
        
        // –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π - –ò–°–ü–†–ê–í–õ–ï–ù–û!
        const users = {
            'emp123dan': {
                password: 'Lyusek2020',
                name: 'Daniel',
                bio: 'sacred emperor, writer'
            },
            'blueisthebestcolor': {
                password: '123blue123',
                name: 'Blue_The_Drak',
                bio: 'nobleman, loves dragons'
            },
            'theemperorsson': {
                password: 'vikings123power',
                name: 'Einar',
                bio: 'nobleman of the royal blood'
            },
            'ottobutnotottoman': {
                password: 'verdeilineverde',
                name: 'Otto',
                bio: 'nobleman, captain'
            },
            'defenseqwerty': {
                password: '123church123',
                name: 'Def',
                bio: 'nobleman, lucky, high inquisitor, loves fishing'
            },
            'pyroorpairo': {
                password: 'iguesspairo123',
                name: 'Pairo',
                bio: 'professor, scientist'
            },
            'bluebecauseblue': {
                password: 'notthedragons123',
                name: 'Blue2',
                bio: 'the brother of other Blue, nobleman, explorer'
            },
            'Russell': {
                password: '123emperorsfriend$',
                name: 'Russel.A',
                bio: 'businessman, nobleman, a dangerous man in the Empire, have a good relationship with emperor'
            }
        };
        
        // –¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç–∞–∫—Ç
        let currentUser = null;
        let selectedContact = null;
        let privateMessages = {};
        let unreadCounts = {};
        
        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –∑–≤–æ–Ω–∫–æ–≤
        let peerConnection = null;
        let localStream = null;
        let currentCallId = null;
        let callListeners = {};
        
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è STUN —Å–µ—Ä–≤–µ—Ä–æ–≤ –¥–ª—è WebRTC
        const iceServers = {
            iceServers: [
                { urls: 'stun:stun.l.google.com:19302' },
                { urls: 'stun:stun1.l.google.com:19302' }
            ]
        };
        
        // –§—É–Ω–∫—Ü–∏—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
        function isMobileDevice() {
            return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase
        function initFirebase() {
            try {
                firebaseApp = firebase.initializeApp(firebaseConfig);
                database = firebase.database();
                avatarsRef = database.ref('avatars');
                callsRef = database.ref('calls');
                isFirebaseConnected = true;
                console.log("Firebase Database initialized successfully");
                
                // –∑–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –∞–≤–∞—Ç–∞—Ä–æ–∫ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
                loadAllAvatars();
                
                return true;
            } catch (error) {
                console.error("Firebase initialization error:", error);
                return false;
            }
        }
        
        // –õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –∞–≤–∞—Ç–∞—Ä–æ–∫ –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –∑–∞–¥–µ—Ä–∂–µ–∫
        function loadAllAvatars() {
            if (!isFirebaseConnected) return;
            
            avatarsRef.once('value', (snapshot) => {
                const avatars = snapshot.val() || {};
                
                // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –∫—ç—à
                Object.keys(avatars).forEach(userId => {
                    if (avatars[userId] && avatars[userId].data) {
                        avatarCache[userId] = avatars[userId].data;
                    }
                });
                
                console.log("Avatars loaded:", Object.keys(avatarCache).length);
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI –ø–æ –Ω—É–∂–¥–µ
                updateAllAvatars();
            });
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –∞–≤–∞—Ç–∞—Ä–æ–∫ –≤ UI
        function updateAllAvatars() {
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∫–∏ –≤ –ø—É–±–ª–∏—á–Ω–æ–º —á–∞—Ç–µ
            const publicMessages = document.getElementById('publicChatMessages');
            if (publicMessages) {
                const avatars = publicMessages.querySelectorAll('.message-avatar');
                avatars.forEach(img => {
                    const userId = img.getAttribute('data-user-id');
                    if (userId && avatarCache[userId]) {
                        img.src = avatarCache[userId];
                    }
                });
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤
            updateContactsList();
        }
        
        // –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function getAvatarUrl(userId, callback) {
            // –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫—ç—à–∞ –≤ –Ω–∞—á–∞–ª–µ
            if (avatarCache[userId]) {
                if (callback) callback(avatarCache[userId]);
                return avatarCache[userId];
            }
            
            // –í–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ –∑–∞–≥–ª—É—à–∫–∏ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ
            if (isFirebaseConnected) {
                avatarsRef.child(userId).once('value', (snapshot) => {
                    const avatarData = snapshot.val();
                    if (avatarData && avatarData.data) {
                        avatarCache[userId] = avatarData.data;
                        if (callback) callback(avatarData.data);
                        
                        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å —ç—Ç–∏–º userId
                        updateAvatarElements(userId, avatarData.data);
                    } else {
                        // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∑–∞–≥–ª—É—à–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                        const defaultAvatar = getDefaultAvatar();
                        avatarCache[userId] = defaultAvatar;
                        if (callback) callback(defaultAvatar);
                    }
                });
            }
            
            return getDefaultAvatar();
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º userId
        function updateAvatarElements(userId, avatarUrl) {
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ –ø—É–±–ª–∏—á–Ω–æ–º —á–∞—Ç–µ
            const publicAvatars = document.querySelectorAll(`.message-avatar[data-user-id="${userId}"]`);
            publicAvatars.forEach(img => {
                img.src = avatarUrl;
            });
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ —Å–ø–∏—Å–∫–µ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤
            const contactAvatars = document.querySelectorAll(`.contact-avatar[data-user-id="${userId}"]`);
            contactAvatars.forEach(img => {
                img.src = avatarUrl;
            });
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö
            const privateAvatars = document.querySelectorAll(`.private-message-avatar[data-user-id="${userId}"]`);
            privateAvatars.forEach(img => {
                img.src = avatarUrl;
            });
        }
        
        // –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        function getDefaultAvatar() {
            return 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgdmlld0JveD0iMCAwIDEwMCAxMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxMDAiIGhlaWdodD0iMTAwIiBmaWxsPSIjMWExMjdlIi8+CjxwYXRoIGQ9Ik01MCAzMEM1Ny45NTU5IDMwIDY0IDM2LjA0NDEgNjQgNDRDNjQgNTEuOTU1OSA1Ny45NTU5IDU4IDUwIDU4QzQyLjA0NDEgNTggMzYgNTEuOTU1OSAzNiA0NEMzNiAzNi4wNDQxIDQyLjA0NDEgMzAgNTAgMzBaIiBmaWxsPSJncmF5Ii8+CjxwYXRoIGQ9Ik0yMCA4MEw4MCA4MEw4MCA5MEwyMCA5MEwyMCA4MFoiIGZpbGw9ImdyYXkiLz4KPC9zdmc+';
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∫–∏ –≤ Firebase
        function saveAvatarToFirebase(userId, avatarData) {
            if (!isFirebaseConnected) return false;
            
            try {
                // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ Firebase
                avatarsRef.child(userId).set({
                    data: avatarData,
                    updatedAt: Date.now()
                });
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—ç—à
                avatarCache[userId] = avatarData;
                
                return true;
            } catch (error) {
                console.error("Error saving avatar:", error);
                return false;
            }
        }
        
        // –§—É–Ω–∫—Ü–∏–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
        function encryptMessage(text, key) {
            try {
                return CryptoJS.AES.encrypt(text, key).toString();
            } catch (error) {
                console.error("Encryption error:", error);
                return text;
            }
        }
        
        function decryptMessage(encryptedText, key) {
            try {
                const bytes = CryptoJS.AES.decrypt(encryptedText, key);
                return bytes.toString(CryptoJS.enc.Utf8);
            } catch (error) {
                console.error("Decryption error:", error);
                return "[Encrypted message]";
            }
        }
        
        // –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–ª—é—á–∞ –¥–ª—è –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ —á–∞—Ç–∞ –º–µ–∂–¥—É –¥–≤—É–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
        function getPrivateChatKey(user1, user2) {
            const users = [user1, user2].sort();
            return CryptoJS.SHA256(users[0] + users[1] + "private_empire_key").toString();
        }
        
        // –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ø—É–±–ª–∏—á–Ω–æ–º—É —á–∞—Ç—É Firebase
        function connectToPublicChat() {
            if (!isFirebaseConnected || !currentUser) return;
            
            try {
                publicChatRef = database.ref('publicChat/messages');
                
                publicChatRef.limitToLast(100).on('value', (snapshot) => {
                    const messages = snapshot.val() || {};
                    updatePublicChatDisplay(messages);
                });
                
                return true;
            } catch (error) {
                console.error("Firebase public chat connection error:", error);
                return false;
            }
        }
        
        // –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ª–∏—á–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏—è–º
        function connectToPrivateMessages() {
            if (!isFirebaseConnected || !currentUser) return;
            
            try {
                privateMessagesRef = database.ref(`privateMessages/${currentUser.username}`);
                
                privateMessagesRef.on('value', (snapshot) => {
                    const messages = snapshot.val() || {};
                    privateMessages = messages;
                    
                    calculateUnreadCounts();
                    updateContactsList();
                    
                    if (selectedContact) {
                        displayPrivateMessages(selectedContact);
                    }
                });
                
                return true;
            } catch (error) {
                console.error("Firebase private messages connection error:", error);
                return false;
            }
        }
        
        // –ü–æ–¥—Å—á–µ—Ç –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
        function calculateUnreadCounts() {
            unreadCounts = {};
            let totalUnread = 0;
            
            if (!privateMessages) return;
            
            Object.keys(privateMessages).forEach(contact => {
                const messages = privateMessages[contact] || {};
                const messagesArray = Object.values(messages);
                
                const unread = messagesArray.filter(msg => 
                    msg.sender === contact && !msg.read
                ).length;
                
                if (unread > 0) {
                    unreadCounts[contact] = unread;
                    totalUnread += unread;
                }
            });
            
            const totalUnreadBadge = document.getElementById('totalUnreadBadge');
            if (totalUnreadBadge) {
                if (totalUnread > 0) {
                    totalUnreadBadge.style.display = 'inline';
                    totalUnreadBadge.textContent = totalUnread;
                } else {
                    totalUnreadBadge.style.display = 'none';
                }
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ —á–∞—Ç–∞
        function updatePublicChatDisplay(messages) {
            const chatMessagesElement = document.getElementById('publicChatMessages');
            if (!chatMessagesElement) return;
            
            const messagesArray = Object.values(messages).sort((a, b) => a.timestamp - b.timestamp);
            
            chatMessagesElement.innerHTML = '';
            
            if (messagesArray.length === 0) {
                chatMessagesElement.innerHTML = '<div class="chat-notice">Welcome to the Imperial Public Chat! All messages are encrypted for security.</div>';
            } else {
                messagesArray.forEach(msg => {
                    const messageDiv = document.createElement('div');
                    
                    if (msg.type === 'system') {
                        messageDiv.className = 'message system-message';
                        messageDiv.innerHTML = `
                            <div class="message-content">${msg.text}</div>
                            <div class="message-time">${msg.time}</div>
                        `;
                    } else {
                        let decryptedText = msg.text;
                        if (msg.encrypted) {
                            decryptedText = decryptMessage(msg.text, PUBLIC_ENCRYPTION_KEY);
                        }
                        
                        // –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∫–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ
                        const avatarUrl = getAvatarUrl(msg.userId);
                        
                        messageDiv.className = 'message';
                        messageDiv.innerHTML = `
                            <img src="${avatarUrl}" class="message-avatar" data-user-id="${msg.userId}" alt="${msg.user}">
                            <div class="message-content-wrapper">
                                <div class="message-header">
                                    <span class="message-user">${msg.user}</span>
                                    <span class="message-time">${msg.time}</span>
                                </div>
                                <div class="message-content">${decryptedText}</div>
                                <div class="encryption-badge">üîí Public chat encryption</div>
                            </div>
                        `;
                    }
                    
                    chatMessagesElement.appendChild(messageDiv);
                });
            }
            
            setTimeout(() => {
                chatMessagesElement.scrollTop = chatMessagesElement.scrollHeight;
            }, 100);
        }
        
        // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –ø—É–±–ª–∏—á–Ω—ã–π —á–∞—Ç
        function sendPublicMessage() {
            const input = document.getElementById('publicChatInput');
            const message = input.value.trim();
            
            if (message && currentUser && isFirebaseConnected && publicChatRef) {
                const encrypted = encryptMessage(message, PUBLIC_ENCRYPTION_KEY);
                
                const messageObj = {
                    user: currentUser.name,
                    text: encrypted,
                    time: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}),
                    timestamp: Date.now(),
                    type: 'user',
                    userId: currentUser.username,
                    encrypted: true
                };
                
                publicChatRef.push(messageObj);
                input.value = '';
            }
        }
        
        // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
        function sendSystemMessage(text) {
            if (!isFirebaseConnected || !publicChatRef) return;
            
            const message = {
                text: text,
                time: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}),
                timestamp: Date.now(),
                type: 'system'
            };
            
            publicChatRef.push(message);
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤
        function updateContactsList() {
            const contactsList = document.getElementById('contactsList');
            if (!contactsList || !currentUser) return;
            
            let html = '';
            
            const contacts = Object.keys(users).filter(username => username !== currentUser.username);
            
            if (contacts.length === 0) {
                html = '<div class="chat-notice">No other citizens found</div>';
            } else {
                contacts.sort((a, b) => {
                    const unreadA = unreadCounts[a] || 0;
                    const unreadB = unreadCounts[b] || 0;
                    if (unreadA !== unreadB) {
                        return unreadB - unreadA;
                    }
                    return users[a].name.localeCompare(users[b].name);
                });
                
                contacts.forEach(username => {
                    const user = users[username];
                    const avatarUrl = getAvatarUrl(username);
                    const unread = unreadCounts[username] || 0;
                    
                    let lastMessageText = '';
                    const contactMessages = privateMessages[username];
                    if (contactMessages) {
                        const messagesArray = Object.values(contactMessages);
                        if (messagesArray.length > 0) {
                            const lastMsg = messagesArray.sort((a, b) => b.timestamp - a.timestamp)[0];
                            if (lastMsg) {
                                if (lastMsg.sender === currentUser.username) {
                                    lastMessageText = 'You: ‚Ä¢‚Ä¢‚Ä¢';
                                } else {
                                    lastMessageText = 'New message';
                                }
                            }
                        }
                    }
                    
                    html += `
                        <div class="contact-item ${selectedContact === username ? 'active' : ''}" onclick="selectContact('${username}')">
                            <img src="${avatarUrl}" class="contact-avatar" data-user-id="${username}" alt="${user.name}">
                            <div class="contact-info">
                                <span class="contact-name">${user.name}</span>
                                <span class="contact-last-message">${lastMessageText || 'No messages yet'}</span>
                            </div>
                            ${unread > 0 ? `<span class="contact-unread">${unread}</span>` : ''}
                        </div>
                    `;
                });
            }
            
            contactsList.innerHTML = html;
        }
        
        // –í—ã–±–æ—Ä –∫–æ–Ω—Ç–∞–∫—Ç–∞ –¥–ª—è –æ–±—â–µ–Ω–∏—è
        function selectContact(username) {
            selectedContact = username;
            
            markMessagesAsRead(username);
            updateContactsList();
            
            document.getElementById('privateChatHeader').textContent = `‚úâÔ∏è Chat with ${users[username].name}`;
            
            document.getElementById('privateChatInput').disabled = false;
            document.getElementById('sendPrivateButton').disabled = false;
            document.getElementById('callButton').disabled = false;
            
            displayPrivateMessages(username);
            
            setTimeout(() => {
                document.getElementById('privateChatInput').focus();
            }, 100);
        }
        
        // –ü–æ–º–µ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–µ
        function markMessagesAsRead(contactUsername) {
            if (!isFirebaseConnected || !currentUser) return;
            
            const messages = privateMessages[contactUsername];
            if (!messages) return;
            
            Object.keys(messages).forEach(msgKey => {
                const msg = messages[msgKey];
                if (msg.sender === contactUsername && !msg.read) {
                    database.ref(`privateMessages/${currentUser.username}/${contactUsername}/${msgKey}`).update({
                        read: true
                    });
                }
            });
        }
        
        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
        function displayPrivateMessages(contactUsername) {
            const privateMessagesElement = document.getElementById('privateMessages');
            if (!privateMessagesElement) return;
            
            privateMessagesElement.innerHTML = '';
            
            const contactMessages = privateMessages[contactUsername] || {};
            const messagesArray = Object.values(contactMessages).sort((a, b) => a.timestamp - b.timestamp);
            
            if (messagesArray.length === 0) {
                privateMessagesElement.innerHTML = '<div class="chat-notice">No messages yet. Send your first message!</div>';
                return;
            }
            
            messagesArray.forEach(msg => {
                const messageDiv = document.createElement('div');
                
                const chatKey = getPrivateChatKey(msg.sender, msg.sender === currentUser.username ? contactUsername : currentUser.username);
                
                let decryptedText = msg.text;
                if (msg.encrypted) {
                    decryptedText = decryptMessage(msg.text, chatKey);
                }
                
                const isCurrentUser = msg.sender === currentUser.username;
                const senderName = isCurrentUser ? currentUser.name : users[msg.sender].name;
                const senderUsername = msg.sender;
                
                const avatarUrl = getAvatarUrl(senderUsername);
                
                messageDiv.className = 'message';
                messageDiv.innerHTML = `
                    <img src="${avatarUrl}" class="message-avatar private-message-avatar" data-user-id="${senderUsername}" alt="${senderName}">
                    <div class="message-content-wrapper">
                        <div class="message-header">
                            <span class="message-user">${senderName}</span>
                            <span class="message-time">${msg.time}</span>
                        </div>
                        <div class="message-content">${decryptedText}</div>
                        <div class="encryption-badge">üîí End-to-end encrypted</div>
                    </div>
                `;
                
                privateMessagesElement.appendChild(messageDiv);
            });
            
            setTimeout(() => {
                privateMessagesElement.scrollTop = privateMessagesElement.scrollHeight;
            }, 100);
        }
        
        // –û—Ç–ø—Ä–∞–≤–∫–∞ –ª–∏—á–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
        function sendPrivateMessage() {
            const input = document.getElementById('privateChatInput');
            const message = input.value.trim();
            
            if (message && currentUser && selectedContact && isFirebaseConnected) {
                const chatKey = getPrivateChatKey(currentUser.username, selectedContact);
                const messageText = encryptMessage(message, chatKey);
                
                const messageObj = {
                    sender: currentUser.username,
                    text: messageText,
                    time: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}),
                    timestamp: Date.now(),
                    encrypted: true,
                    read: false
                };
                
                const senderRef = database.ref(`privateMessages/${currentUser.username}/${selectedContact}`).push();
                senderRef.set({...messageObj, read: true});
                
                const receiverObj = {...messageObj, read: false};
                const receiverRef = database.ref(`privateMessages/${selectedContact}/${currentUser.username}`).push();
                receiverRef.set(receiverObj);
                
                input.value = '';
            }
        }
        
        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Å–∏—Å—Ç–µ–º—ã –≤—Ö–æ–¥–∞
        function showLoginModal() {
            document.getElementById('loginModal').classList.add('active');
            document.getElementById('loginError').style.display = 'none';
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
            setTimeout(() => {
                document.getElementById('username').focus();
            }, 100);
        }
        
        function closeLoginModal() {
            document.getElementById('loginModal').classList.remove('active');
        }
        
        function login() {
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value;
            const errorElement = document.getElementById('loginError');
            
            if (users[username] && users[username].password === password) {
                currentUser = {
                    username: username,
                    ...users[username]
                };
                
                // –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∫–∏ –∏–∑ Firebase
                getAvatarUrl(username, (avatarUrl) => {
                    currentUser.avatarUrl = avatarUrl;
                    updateAvatarInUI();
                });
                
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                closeLoginModal();
                
                document.getElementById('loginButtonContainer').style.display = 'none';
                document.getElementById('userMenu').classList.add('active');
                document.getElementById('userName').textContent = currentUser.name;
                
                if (isFirebaseConnected && !isMobileDevice()) {
                    // –°–ª—É—à–∞–µ–º –≤—Ö–æ–¥—è—â–∏–µ –∑–≤–æ–Ω–∫–∏ —Ç–æ–ª—å–∫–æ –Ω–∞ –ü–ö
                    listenForIncomingCalls();
                }
                
                if (isFirebaseConnected) {
                    connectToPublicChat();
                    connectToPrivateMessages();
                    sendSystemMessage(`${currentUser.name} has entered the Imperial Public Chat. Long live the Empire!`);
                }
                
                alert(`Welcome to the Empire, ${currentUser.name}!`);
            } else {
                errorElement.style.display = 'block';
                document.getElementById('username').style.borderColor = '#ff4444';
                document.getElementById('password').style.borderColor = '#ff4444';
            }
        }
        
        function toggleUserMenu() {
            const dropdown = document.getElementById('userDropdown');
            dropdown.classList.toggle('active');
        }
        
        document.addEventListener('click', function(event) {
            const userMenu = document.getElementById('userMenu');
            const userButton = userMenu.querySelector('.user-button');
            const dropdown = document.getElementById('userDropdown');
            
            if (userMenu.classList.contains('active') && 
                !userButton.contains(event.target) && 
                !dropdown.contains(event.target)) {
                dropdown.classList.remove('active');
            }
        });
        
        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∞–≤–∞—Ç–∞—Ä–∫–æ–π
        function uploadAvatar() {
            const input = document.getElementById('avatarUpload');
            const file = input.files[0];
            
            if (!file) {
                alert('Please select an image file');
                return;
            }
            
            if (file.size > 2 * 1024 * 1024) {
                alert('Image size should be less than 2MB');
                return;
            }
            
            if (!file.type.match('image/jpeg') && !file.type.match('image/png') && !file.type.match('image/gif')) {
                alert('Please select a valid image file (JPEG, PNG, or GIF)');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                document.getElementById('avatarPreview').src = e.target.result;
            };
            reader.readAsDataURL(file);
        }
        
        function saveNewAvatar() {
            const input = document.getElementById('avatarUpload');
            const file = input.files[0];
            
            if (!file) {
                alert('Please select an image first');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const avatarData = e.target.result;
                
                // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ Firebase
                if (isFirebaseConnected) {
                    saveAvatarToFirebase(currentUser.username, avatarData);
                }
                
                // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ –¥–ª—è —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏
                currentUser.avatarUrl = avatarData;
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                
                updateAvatarInUI();
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –∞–≤–∞—Ç–∞—Ä–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ UI
                updateAvatarElements(currentUser.username, avatarData);
                
                alert('Avatar updated successfully! It is now visible to all citizens.');
            };
            reader.readAsDataURL(file);
        }
        
        function updateAvatarInUI() {
            if (currentUser && currentUser.avatarUrl) {
                const avatarIcon = document.getElementById('userAvatarIcon');
                if (avatarIcon) {
                    avatarIcon.innerHTML = `<img src="${currentUser.avatarUrl}" style="width: 20px; height: 20px; border-radius: 50%; border: 1px solid gold;">`;
                }
            }
        }
        
        function showPersonalCabinet() {
            document.getElementById('userDropdown').classList.remove('active');
            
            const cabinetContent = document.getElementById('cabinetContent');
            
            if (currentUser) {
                getAvatarUrl(currentUser.username, (avatarUrl) => {
                    cabinetContent.innerHTML = `
                        <div class="avatar-container">
                            <img src="${avatarUrl}" id="avatarPreview" class="avatar-preview" alt="Your Avatar">
                            <div>
                                <label for="avatarUpload" class="avatar-upload-label">
                                    Choose New Avatar
                                </label>
                                <input type="file" id="avatarUpload" class="avatar-upload-input" accept="image/jpeg,image/png,image/gif" onchange="uploadAvatar()">
                            </div>
                            <button class="change-avatar-button" onclick="saveNewAvatar()">Save Avatar</button>
                            <div class="avatar-message">Maximum size: 2MB. Formats: JPG, PNG, GIF</div>
                            <div class="avatar-message">‚úÖ Your avatar will be visible to all citizens</div>
                        </div>
                        <div class="profile-info">
                            <h3>Imperial Citizen Profile</h3>
                            <p><strong>Login:</strong> ${currentUser.username}</p>
                            <p><strong>Name:</strong> ${currentUser.name}</p>
                            <p><strong>Bio:</strong> ${currentUser.bio}</p>
                            <p><strong>Status:</strong> Verified Citizen of the Empire</p>
                            <p><strong>Encryption:</strong> AES-256 active for all chats</p>
                            <p><strong>Avatar:</strong> Shared with all citizens</p>
                        </div>
                        <button class="logout-button" onclick="logout()">Logout from Empire</button>
                    `;
                });
            }
            
            document.getElementById('personalCabinetModal').classList.add('active');
        }
        
        function closePersonalCabinet() {
            document.getElementById('personalCabinetModal').classList.remove('active');
        }
        
        function showPublicChat() {
            document.getElementById('userDropdown').classList.remove('active');
            
            if (currentUser) {
                document.getElementById('publicChatModal').classList.add('active');
                
                setTimeout(() => {
                    document.getElementById('publicChatInput').focus();
                }, 100);
            }
        }
        
        function closePublicChat() {
            document.getElementById('publicChatModal').classList.remove('active');
            document.getElementById('publicChatInput').value = '';
        }
        
        function showPrivateMessages() {
            document.getElementById('userDropdown').classList.remove('active');
            
            if (currentUser) {
                document.getElementById('privateMessagesModal').classList.add('active');
                updateContactsList();
                
                if (selectedContact) {
                    selectContact(selectedContact);
                }
            }
        }
        
        function closePrivateMessages() {
            document.getElementById('privateMessagesModal').classList.remove('active');
            selectedContact = null;
        }
        
        function closeMobileWarning() {
            document.getElementById('mobileWarningModal').classList.remove('active');
        }
        
        function handleCallButtonClick() {
            if (isMobileDevice()) {
                // –ù–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
                document.getElementById('mobileWarningModal').classList.add('active');
            } else {
                // –ù–∞ –ü–ö –∏–Ω–∏—Ü–∏–∏—Ä—É–µ–º –∑–≤–æ–Ω–æ–∫
                initiateCall();
            }
        }
        
        function logout() {
            if (currentUser) {
                sendSystemMessage(`${currentUser.name} has left the Imperial Public Chat.`);
            }
            
            // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –∑–≤–æ–Ω–∫–∞ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ
            if (currentCallId) {
                endCall();
            }
            
            // –û—á–∏—Å—Ç–∫–∞ —Å–ª—É—à–∞—Ç–µ–ª–µ–π –∑–≤–æ–Ω–∫–æ–≤
            if (callListeners.incoming) {
                callListeners.incoming.off();
            }
            
            currentUser = null;
            selectedContact = null;
            privateMessages = {};
            unreadCounts = {};
            localStorage.removeItem('currentUser');
            
            document.getElementById('userMenu').classList.remove('active');
            document.getElementById('loginButtonContainer').style.display = 'block';
            document.getElementById('userDropdown').classList.remove('active');
            
            closePersonalCabinet();
            closePublicChat();
            closePrivateMessages();
            
            alert('You have left the Empire. Until we meet again!');
        }
        
        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∑–≤–æ–Ω–∫–æ–≤ (—Ç–æ–ª—å–∫–æ –¥–ª—è –ü–ö)
        function listenForIncomingCalls() {
            if (!isFirebaseConnected || !currentUser || isMobileDevice()) return;
            
            // –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–ª—É—à–∞—Ç–µ–ª—è
            if (callListeners.incoming) {
                callListeners.incoming.off();
            }
            
            // –°–ª—É—à–∞–µ–º –≤—Ö–æ–¥—è—â–∏–µ –∑–≤–æ–Ω–∫–∏
            callListeners.incoming = callsRef.child(currentUser.username).on('value', (snapshot) => {
                const calls = snapshot.val() || {};
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –≤—Ö–æ–¥—è—â–µ–≥–æ –∑–≤–æ–Ω–∫–∞
                Object.keys(calls).forEach(callId => {
                    const call = calls[callId];
                    if (call && call.status === 'ringing' && !currentCallId) {
                        showIncomingCall(callId, call);
                    }
                });
            });
        }
        
        function showIncomingCall(callId, call) {
            currentCallId = callId;
            
            const modal = document.getElementById('callModal');
            const title = document.getElementById('callTitle');
            const status = document.getElementById('callStatus');
            const actions = document.getElementById('callActions');
            
            title.textContent = 'Incoming Call';
            status.textContent = `${users[call.caller].name} is calling you...`;
            
            actions.innerHTML = `
                <button class="call-accept" onclick="acceptCall('${callId}')">Accept</button>
                <button class="call-reject" onclick="rejectCall('${callId}')">Reject</button>
            `;
            
            modal.classList.add('active');
        }
        
        function initiateCall() {
            if (!selectedContact || !currentUser || !isFirebaseConnected || isMobileDevice()) return;
            
            // –°–æ–∑–¥–∞–Ω–∏–µ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ ID –∑–≤–æ–Ω–∫–∞
            const callId = `${currentUser.username}_${selectedContact}_${Date.now()}`;
            
            // –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –æ –∑–≤–æ–Ω–∫–µ –≤ Firebase
            callsRef.child(selectedContact).child(callId).set({
                caller: currentUser.username,
                callee: selectedContact,
                status: 'ringing',
                timestamp: Date.now()
            });
            
            currentCallId = callId;
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ WebRTC
            setupPeerConnection(callId, true);
            
            // –ü–æ–ª—É—á–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∞—É–¥–∏–æ (—Ç–æ–ª—å–∫–æ –∞—É–¥–∏–æ!)
            navigator.mediaDevices.getUserMedia({ audio: true, video: false })
                .then(stream => {
                    localStream = stream;
                    
                    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∞—É–¥–∏–æ —Ç—Ä–µ–∫–æ–≤ –≤ peer connection
                    stream.getAudioTracks().forEach(track => {
                        peerConnection.addTrack(track, stream);
                    });
                    
                    // –°–æ–∑–¥–∞–Ω–∏–µ offer
                    return peerConnection.createOffer();
                })
                .then(offer => {
                    return peerConnection.setLocalDescription(offer);
                })
                .then(() => {
                    // –û—Ç–ø—Ä–∞–≤–∫–∞ offer —á–µ—Ä–µ–∑ Firebase
                    callsRef.child(selectedContact).child(callId).update({
                        offer: peerConnection.localDescription,
                        status: 'calling'
                    });
                })
                .catch(error => {
                    console.error('Error initiating call:', error);
                    endCall();
                });
            
            // –ü–æ–∫–∞–∑ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
            const modal = document.getElementById('callModal');
            const title = document.getElementById('callTitle');
            const status = document.getElementById('callStatus');
            const actions = document.getElementById('callActions');
            
            title.textContent = 'Calling...';
            status.textContent = `Calling ${users[selectedContact].name}...`;
            
            actions.innerHTML = `
                <button class="call-end" onclick="endCall()">End Call</button>
            `;
            
            modal.classList.add('active');
            
            // –°–ª—É—à–∞–µ–º –æ—Ç–≤–µ—Ç –Ω–∞ –∑–≤–æ–Ω–æ–∫
            callsRef.child(selectedContact).child(callId).on('value', (snapshot) => {
                const call = snapshot.val();
                if (!call) return;
                
                if (call.answer && peerConnection && !peerConnection.currentRemoteDescription) {
                    peerConnection.setRemoteDescription(new RTCSessionDescription(call.answer));
                }
                
                if (call.candidate && peerConnection) {
                    peerConnection.addIceCandidate(new RTCIceCandidate(call.candidate));
                }
                
                if (call.status === 'ended') {
                    endCall();
                }
            });
        }
        
        function acceptCall(callId) {
            const modal = document.getElementById('callModal');
            const title = document.getElementById('callTitle');
            const status = document.getElementById('callStatus');
            const actions = document.getElementById('callActions');
            
            title.textContent = 'In Call';
            status.textContent = `Connected with ${users[selectedContact].name}`;
            
            actions.innerHTML = `
                <button class="call-end" onclick="endCall()">End Call</button>
            `;
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ WebRTC
            setupPeerConnection(callId, false);
            
            // –ü–æ–ª—É—á–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∞—É–¥–∏–æ (—Ç–æ–ª—å–∫–æ –∞—É–¥–∏–æ!)
            navigator.mediaDevices.getUserMedia({ audio: true, video: false })
                .then(stream => {
                    localStream = stream;
                    
                    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∞—É–¥–∏–æ —Ç—Ä–µ–∫–æ–≤ –≤ peer connection
                    stream.getAudioTracks().forEach(track => {
                        peerConnection.addTrack(track, stream);
                    });
                    
                    // –ü–æ–ª—É—á–µ–Ω–∏–µ offer –∏–∑ Firebase
                    callsRef.child(currentUser.username).child(callId).once('value', (snapshot) => {
                        const call = snapshot.val();
                        if (call && call.offer) {
                            peerConnection.setRemoteDescription(new RTCSessionDescription(call.offer))
                                .then(() => peerConnection.createAnswer())
                                .then(answer => peerConnection.setLocalDescription(answer))
                                .then(() => {
                                    // –û—Ç–ø—Ä–∞–≤–∫–∞ answer
                                    callsRef.child(currentUser.username).child(callId).update({
                                        answer: peerConnection.localDescription,
                                        status: 'connected'
                                    });
                                });
                        }
                    });
                })
                .catch(error => {
                    console.error('Error accepting call:', error);
                    endCall();
                });
        }
        
        function rejectCall(callId) {
            callsRef.child(currentUser.username).child(callId).update({
                status: 'rejected'
            });
            
            callsRef.child(currentUser.username).child(callId).remove();
            closeCallModal();
        }
        
        function endCall() {
            if (peerConnection) {
                peerConnection.close();
                peerConnection = null;
            }
            
            if (localStream) {
                localStream.getAudioTracks().forEach(track => track.stop());
                localStream = null;
            }
            
            if (currentCallId) {
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–≤–æ–Ω–∫–∞
                if (selectedContact) {
                    callsRef.child(selectedContact).child(currentCallId).update({
                        status: 'ended'
                    });
                }
                callsRef.child(currentUser.username).child(currentCallId).remove();
                currentCallId = null;
            }
            
            closeCallModal();
        }
        
        function closeCallModal() {
            document.getElementById('callModal').classList.remove('active');
        }
        
        function setupPeerConnection(callId, isInitiator) {
            peerConnection = new RTCPeerConnection(iceServers);
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ ICE –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤
            peerConnection.onicecandidate = (event) => {
                if (event.candidate) {
                    const target = isInitiator ? selectedContact : currentUser.username;
                    callsRef.child(target).child(callId).update({
                        candidate: event.candidate
                    });
                }
            };
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –∞—É–¥–∏–æ –ø–æ—Ç–æ–∫–∞
            peerConnection.ontrack = (event) => {
                // –°–æ–∑–¥–∞–µ–º –∞—É–¥–∏–æ —ç–ª–µ–º–µ–Ω—Ç –∏ –ø–æ–¥–∫–ª—é—á–∞–µ–º –ø–æ—Ç–æ–∫
                const audio = new Audio();
                audio.srcObject = event.streams[0];
                audio.autoplay = true;
                audio.play().catch(e => console.log('Audio play failed:', e));
            };
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏—è Enter
        document.addEventListener('DOMContentLoaded', function() {
            const publicChatInput = document.getElementById('publicChatInput');
            if (publicChatInput) {
                publicChatInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        sendPublicMessage();
                    }
                });
            }
            
            const privateChatInput = document.getElementById('privateChatInput');
            if (privateChatInput) {
                privateChatInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        sendPrivateMessage();
                    }
                });
            }
            
            document.getElementById('password')?.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    login();
                }
            });
        });
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
        document.addEventListener('DOMContentLoaded', function() {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                modal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        this.classList.remove('active');
                        if (this.id === 'loginModal') {
                            closeLoginModal();
                        } else if (this.id === 'publicChatModal') {
                            closePublicChat();
                        } else if (this.id === 'privateMessagesModal') {
                            closePrivateMessages();
                        } else if (this.id === 'personalCabinetModal') {
                            closePersonalCabinet();
                        } else if (this.id === 'callModal') {
                            endCall();
                        } else if (this.id === 'mobileWarningModal') {
                            closeMobileWarning();
                        }
                    }
                });
            });
        });
        
        function showPage(pageId) {
            const pages = document.querySelectorAll('.page');
            pages.forEach(page => {
                page.classList.remove('active');
            });
            
            document.getElementById(pageId).classList.add('active');
            return false;
        }
        
        function openTab(evt, tabName) {
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(tab => {
                tab.classList.remove('active');
            });
            
            const tabButtons = document.querySelectorAll('.tab-button');
            tabButtons.forEach(button => {
                button.classList.remove('active');
            });
            
            document.getElementById(tabName).classList.add('active');
            evt.currentTarget.classList.add('active');
            
            evt.preventDefault();
        }
        
        function openMediaTab(evt, tabName) {
            const mediaTabContents = document.querySelectorAll('#media .tab-content');
            mediaTabContents.forEach(tab => {
                tab.classList.remove('active');
            });
            
            const mediaTabButtons = document.querySelectorAll('#media .tab-button');
            mediaTabButtons.forEach(button => {
                button.classList.remove('active');
            });
            
            document.getElementById(tabName).classList.add('active');
            evt.currentTarget.classList.add('active');
            
            evt.preventDefault();
        }
        
        function toggleTheme() {
            const body = document.body;
            const themeSwitcher = document.querySelector('.theme-switcher');
            
            if (body.classList.contains('dark-mode')) {
                body.classList.remove('dark-mode');
                themeSwitcher.innerHTML = '<span>‚òÄÔ∏è</span><span>The Sun Scorching Sinners</span><span>|</span><span>The Night - the Outing of Werewolves</span><span>üåô</span>';
            } else {
                body.classList.add('dark-mode');
                themeSwitcher.innerHTML = '<span>üåô</span><span>The Night - the Outing of Werewolves</span><span>|</span><span>The Sun Scorching Sinners</span><span>‚òÄÔ∏è</span>';
            }
            
            localStorage.setItem('theme', body.classList.contains('dark-mode') ? 'dark' : 'light');
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            showPage('home');
            
            initFirebase();
            
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                try {
                    currentUser = JSON.parse(savedUser);
                    
                    document.getElementById('loginButtonContainer').style.display = 'none';
                    document.getElementById('userMenu').classList.add('active');
                    document.getElementById('userName').textContent = currentUser.name;
                    
                    if (isFirebaseConnected) {
                        connectToPublicChat();
                        connectToPrivateMessages();
                        if (!isMobileDevice()) {
                            listenForIncomingCalls();
                        }
                    }
                } catch (error) {
                    console.error("Error loading saved user:", error);
                    localStorage.removeItem('currentUser');
                }
            }
            
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.body.classList.add('dark-mode');
                const themeSwitcher = document.querySelector('.theme-switcher');
                themeSwitcher.innerHTML = '<span>üåô</span><span>The Night - the Outing of Werewolves</span><span>|</span><span>The Sun Scorching Sinners</span><span>‚òÄÔ∏è</span>';
            }
        });
    </script>
</body>
</html>
