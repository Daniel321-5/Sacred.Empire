<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sacred Daniel's Empire | Maritime Kingdom Since 1700 | –ú–æ—Ä—Å–∫–∞—è –ò–º–ø–µ—Ä–∏—è</title>
    <meta name="description" content="Official sovereign maritime state with pirate traditions and naval heritage. –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç –º–æ—Ä—Å–∫–æ–π –∏–º–ø–µ—Ä–∏–∏ —Å —Ç—Ä–∞–¥–∏—Ü–∏—è–º–∏ –∫–æ—Ä–∞–±–ª–µ—Å—Ç—Ä–æ–µ–Ω–∏—è –∏ –ø–∏—Ä–∞—Ç—Å—Ç–≤–∞">
    <meta name="keywords" content="Sacred Daniel's Empire, maritime kingdom, ships, piracy, naval history, Spain colonial era, British navy, marine research, –º–æ—Ä—Å–∫–∞—è –∏–º–ø–µ—Ä–∏—è, –∫–æ—Ä–∞–±–ª–∏, –ø–∏—Ä–∞—Ç—Å—Ç–≤–æ, –∞–±—Å–æ–ª—é—Ç–Ω–∞—è –º–æ–Ω–∞—Ä—Ö–∏—è, –ò—Å–ø–∞–Ω–∏—è, –ë—Ä–∏—Ç–∞–Ω–∏—è">
    <meta name="author" content="Imperial Office of Sacred Daniel's Empire">
    
    <meta property="og:title" content="Sacred Daniel's Empire | Maritime Power Since 1700">
    <meta property="og:description" content="Sovereign naval state with pirate traditions connecting Spain and Britain heritage">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://daniel321-5.github.io/Sacred.Empire/#">
    <meta property="og:image" content="https://daniel321-5.github.io/Sacred.Empire/TBA-SITE/imperial_flag.webp">
    <meta property="og:locale" content="en_US">
    <meta property="og:locale:alternate" content="ru_RU">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Sacred Daniel's Empire | Naval Heritage">
    <meta name="twitter:description" content="Golden Age of Piracy legacy and maritime traditions">
    <meta name="science-keywords" content="marine biology research, Dark Sea anomaly, Prophet Daniel Marine Life Research Center, oceanographic studies, cephalopod morphology, cartilaginous fishes, marine anomalies, oceanic gigantism, behavioral ecology, Pairo.P research, Vladislav.V marine studies, Def State Scientific Institute, marine expeditions 19th century, sea monster research, abyssal zone studies, marine fauna adaptation, oceanic exploration history, marine science empire, biological research institute">

<meta name="science-keywords-ru" content="–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –º–æ—Ä—Å–∫–æ–π –±–∏–æ–ª–æ–≥–∏–∏, –∞–Ω–æ–º–∞–ª–∏—è –¢–µ–º–Ω–æ–≥–æ –º–æ—Ä—è, –ù–∞—É—á–Ω–æ-–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ü–µ–Ω—Ç—Ä –º–æ—Ä—Å–∫–æ–π –∂–∏–∑–Ω–∏ –ø—Ä–æ—Ä–æ–∫–∞ –î–∞–Ω–∏—ç–ª—è, –æ–∫–µ–∞–Ω–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è, –º–æ—Ä—Ñ–æ–ª–æ–≥–∏—è –≥–æ–ª–æ–≤–æ–Ω–æ–≥–∏—Ö, —Ö—Ä—è—â–µ–≤—ã–µ —Ä—ã–±—ã, –º–æ—Ä—Å–∫–∏–µ –∞–Ω–æ–º–∞–ª–∏–∏, –æ–∫–µ–∞–Ω–∏—á–µ—Å–∫–∏–π –≥–∏–≥–∞–Ω—Ç–∏–∑–º, –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∞—è —ç–∫–æ–ª–æ–≥–∏—è, –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –ü–∞–π—Ä–æ.–ü, –º–æ—Ä—Å–∫–∏–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –í–ª–∞–¥–∏—Å–ª–∞–≤–∞.–í, –ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –Ω–∞—É—á–Ω—ã–π –∏–Ω—Å—Ç–∏—Ç—É—Ç –î–µ—Ñ–∞, –º–æ—Ä—Å–∫–∏–µ —ç–∫—Å–ø–µ–¥–∏—Ü–∏–∏ 19 –≤–µ–∫–∞, –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –º–æ—Ä—Å–∫–∏—Ö –º–æ–Ω—Å—Ç—Ä–æ–≤, –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –∞–±–∏—Å—Å–∞–ª—å–Ω–æ–π –∑–æ–Ω—ã, –∞–¥–∞–ø—Ç–∞—Ü–∏—è –º–æ—Ä—Å–∫–æ–π —Ñ–∞—É–Ω—ã, –∏—Å—Ç–æ—Ä–∏—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –æ–∫–µ–∞–Ω–∞, –º–æ—Ä—Å–∫–∞—è –Ω–∞—É–∫–∞ –∏–º–ø–µ—Ä–∏–∏, –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Å—Ç–∏—Ç—É—Ç, –≥–ª—É–±–æ–∫–æ–≤–æ–¥–Ω—ã–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è, –≥–∏–≥–∞–Ω—Ç—Å–∫–∏–µ –∫–∞–ª—å–º–∞—Ä—ã, –Ω–∞—É—á–Ω—ã–µ —ç–∫—Å–ø–µ–¥–∏—Ü–∏–∏, –∑–æ–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è, –º–æ—Ä—Å–∫–∏–µ —á—É–¥–æ–≤–∏—â–∞, —Ç–µ–º–Ω–æ–µ –º–æ—Ä–µ, –∞–Ω–æ–º–∞–ª—å–Ω—ã–µ –º–æ—Ä—Å–∫–∏–µ —Å—É—â–µ—Å—Ç–≤–∞">
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "GovernmentOrganization",
      "name": "Sacred Daniel's Empire",
      "alternateName": ["–ú–æ—Ä—Å–∫–∞—è –ò–º–ø–µ—Ä–∏—è –î–∞–Ω–∏—ç–ª—è", "Daniel's Maritime Kingdom"],
      "description": "Sovereign naval power with pirate traditions | –°—É–≤–µ—Ä–µ–Ω–Ω–∞—è –º–æ—Ä—Å–∫–∞—è –¥–µ—Ä–∂–∞–≤–∞",
      "url": "https://daniel321-5.github.io/Sacred.Empire/#",
      "logo": "https://daniel321-5.github.io/Sacred.Empire/TBA-SITE/imperial_emblem.webp",
      "foundingDate": "1700",
      "keywords": [
        {"@language": "en", "@value": "ships, piracy, naval battles, Spain colonies, British fleet, History, Truth, Daniel, Sacred emperor, TBA"},
        {"@language": "ru", "@value": "–∫–æ—Ä–∞–±–ª–∏, –ø–∏—Ä–∞—Ç—Å—Ç–≤–æ, –º–æ—Ä—Å–∫–∏–µ —Å—Ä–∞–∂–µ–Ω–∏—è, –∫–æ–ª–æ–Ω–∏–∞–ª—å–Ω–∞—è –ò—Å–ø–∞–Ω–∏—è, –ë—Ä–∏—Ç–∞–Ω—Å–∫–∏–π —Ñ–ª–æ—Ç, –ò—Å—Ç–æ—Ä–∏—è, –ü—Ä–∞–≤–¥–∞, –î–∞–Ω–∏—ç–ª—å, –ë–ê, –°–≤—è—â–µ–Ω–Ω—ã–π –∏–º–ø–µ—Ä–∞—Ç–æ—Ä"}
      ],
      "founder": {
        "@type": "Person",
        "name": "Daniel De Courno",
        "description": "Emperor and naval commander | –ò–º–ø–µ—Ä–∞—Ç–æ—Ä and —Ñ–ª–æ—Ç–æ–≤–æ–¥–µ—Ü"
      }
    }
    </script>
    
    <link rel="alternate" hreflang="en" href="https://daniel321-5.github.io/Sacred.Empire/#" />
    <link rel="alternate" hreflang="ru" href="https://daniel321-5.github.io/Sacred.Empire/#" />
    <link rel="alternate" hreflang="x-default" href="https://daniel321-5.github.io/Sacred.Empire/#" />
    
    <link rel="icon" href="TBA-SITE/favicon.webp" type="image/webp">
    <link rel="apple-touch-icon" href="TBA-SITE/apple-icon.webp">
    
    <link rel="canonical" href="https://daniel321-5.github.io/Sacred.Empire/#">
    
    <meta name="theme-color" content="#1a237e">
    <meta name="robots" content="index, follow">
    <meta name="revisit-after" content="7 days">

    <!-- –î–û–ë–ê–í–õ–ï–ù FIREBASE -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –≤—Ö–æ–¥–∞ */
        .login-button-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }
        
        .login-button {
            background-color: #1a237e;
            color: gold;
            border: 2px solid gold;
            border-radius: 5px;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            font-family: 'Times New Roman', serif;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .login-button:hover {
            background-color: #303f9f;
            transform: scale(1.05);
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –º–µ–Ω—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è */
        .user-menu {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: none;
        }
        
        .user-menu.active {
            display: block;
        }
        
        .user-button {
            background-color: #1a237e;
            color: gold;
            border: 2px solid gold;
            border-radius: 5px;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            font-family: 'Times New Roman', serif;
            font-weight: bold;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .user-button:hover {
            background-color: #303f9f;
        }
        
        .dropdown-menu {
            position: absolute;
            top: 100%;
            right: 0;
            background-color: #1a237e;
            border: 2px solid gold;
            border-radius: 5px;
            min-width: 200px;
            margin-top: 5px;
            display: none;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .dropdown-menu.active {
            display: block;
        }
        
        .dropdown-menu button {
            width: 100%;
            padding: 12px 20px;
            background: none;
            border: none;
            color: gold;
            text-align: left;
            cursor: pointer;
            font-family: 'Times New Roman', serif;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        
        .dropdown-menu button:hover {
            background-color: #303f9f;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            border: 3px solid #1a237e;
            position: relative;
        }
        
        body.dark-mode .modal-content {
            background-color: #1e1e1e;
            color: #e0e0e0;
        }
        
        .close-button {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #1a237e;
            font-weight: bold;
            padding: 5px;
        }
        
        body.dark-mode .close-button {
            color: #e0e0e0;
        }
        
        .modal h2 {
            color: #1a237e;
            margin-bottom: 20px;
            border-bottom: 2px solid gold;
            padding-bottom: 10px;
            text-align: center;
        }
        
        body.dark-mode .modal h2 {
            color: gold;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #1a237e;
            font-weight: bold;
        }
        
        body.dark-mode .form-group label {
            color: #bb86fc;
        }
        
        .form-group input {
            width: 100%;
            padding: 10px;
            border: 2px solid #1a237e;
            border-radius: 5px;
            font-size: 16px;
        }
        
        body.dark-mode .form-group input {
            background-color: #2d2d2d;
            color: #e0e0e0;
            border-color: #444;
        }
        
        .submit-button {
            background-color: #1a237e;
            color: gold;
            border: none;
            padding: 12px 30px;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
            width: 100%;
            transition: background-color 0.3s;
            font-weight: bold;
        }
        
        .submit-button:hover {
            background-color: #303f9f;
        }
        
        .error-message {
            color: #ff4444;
            margin-top: 10px;
            display: none;
            text-align: center;
        }
        
        body.dark-mode .error-message {
            color: #ff6b6b;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞ */
        .profile-info {
            background-color: #f8f8f8;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 20px;
            border-left: 4px solid gold;
        }
        
        body.dark-mode .profile-info {
            background-color: #2d2d2d;
        }
        
        .profile-info h3 {
            color: #1a237e;
            margin-bottom: 10px;
            text-align: center;
        }
        
        body.dark-mode .profile-info h3 {
            color: gold;
        }
        
        .profile-info p {
            margin-bottom: 10px;
            padding: 5px 0;
            border-bottom: 1px solid #ddd;
        }
        
        body.dark-mode .profile-info p {
            border-bottom: 1px solid #444;
        }
        
        .logout-button {
            background-color: #d32f2f;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
            width: 100%;
            font-size: 16px;
            font-weight: bold;
            margin-top: 10px;
        }
        
        .logout-button:hover {
            background-color: #b71c1c;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —á–∞—Ç–∞ */
        .chat-container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .chat-header {
            background-color: #1a237e;
            color: gold;
            padding: 15px;
            border-radius: 5px 5px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .chat-messages {
            height: 400px;
            overflow-y: auto;
            background-color: #f5f5f5;
            padding: 20px;
            border-left: 1px solid #ddd;
            border-right: 1px solid #ddd;
        }
        
        body.dark-mode .chat-messages {
            background-color: #2d2d2d;
            border-color: #444;
        }
        
        .message {
            margin-bottom: 15px;
            padding: 10px;
            background-color: white;
            border-radius: 5px;
            border-left: 3px solid #1a237e;
        }
        
        body.dark-mode .message {
            background-color: #1e1e1e;
            border-left-color: gold;
        }
        
        .message.system-message {
            background-color: #e3f2fd;
            border-left-color: #2196f3;
            text-align: center;
            font-style: italic;
        }
        
        body.dark-mode .message.system-message {
            background-color: #0d47a1;
            border-left-color: #64b5f6;
        }
        
        .message-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }
        
        .message-user {
            font-weight: bold;
            color: #1a237e;
        }
        
        body.dark-mode .message-user {
            color: gold;
        }
        
        .message-time {
            color: #666;
            font-size: 0.9em;
        }
        
        body.dark-mode .message-time {
            color: #aaa;
        }
        
        .message-content {
            line-height: 1.4;
        }
        
        .chat-input-container {
            display: flex;
            gap: 10px;
            padding: 15px;
            background-color: #f5f5f5;
            border: 1px solid #ddd;
            border-radius: 0 0 5px 5px;
        }
        
        body.dark-mode .chat-input-container {
            background-color: #2d2d2d;
            border-color: #444;
        }
        
        .chat-input {
            flex: 1;
            padding: 10px;
            border: 2px solid #1a237e;
            border-radius: 5px;
            font-size: 16px;
        }
        
        body.dark-mode .chat-input {
            background-color: #1e1e1e;
            color: #e0e0e0;
            border-color: #444;
        }
        
        .send-button {
            background-color: #1a237e;
            color: gold;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
            font-weight: bold;
        }
        
        .send-button:hover {
            background-color: #303f9f;
        }
        
        .chat-notice {
            text-align: center;
            padding: 20px;
            color: #666;
            font-style: italic;
        }
        
        body.dark-mode .chat-notice {
            color: #aaa;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—è —Ç–µ–º—ã */
        .theme-switcher {
            background: linear-gradient(90deg, #ffeb3b 0%, #1a237e 100%);
            color: #000;
            text-align: center;
            padding: 10px 0;
            font-weight: bold;
            border-bottom: 2px solid gold;
            cursor: pointer;
            user-select: none;
            transition: all 0.3s ease;
        }
        
        .theme-switcher:hover {
            background: linear-gradient(90deg, #ff9800 0%, #0d153a 100%);
            color: #fff;
        }
        
        .theme-switcher span {
            display: inline-block;
            margin: 0 10px;
            font-size: 1.2rem;
        }
        
        body {
            font-family: 'Times New Roman', serif;
            background-color: #f5f5f5;
            color: #333;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            transition: background-color 0.3s, color 0.3s;
        }
        
        /* –¢–µ–º–Ω–∞—è —Ç–µ–º–∞ */
        body.dark-mode {
            background-color: #121212;
            color: #e0e0e0;
        }
        
        body.dark-mode .page {
            background-color: #1e1e1e;
            color: #e0e0e0;
            box-shadow: 0 2px 5px rgba(255, 255, 255, 0.1);
        }
        
        body.dark-mode .hero-card {
            background-color: #2d2d2d;
            border-color: #444;
        }
        
        body.dark-mode .citizenship-form {
            background-color: #2d2d2d;
        }
        
        body.dark-mode .contact-list li {
            background-color: #2d2d2d;
        }
        
        body.dark-mode .research-paper h3,
        body.dark-mode .research-paper h4,
        body.dark-mode .research-paper h5 {
            color: #bb86fc;
        }
        
        body.dark-mode .tabs-container {
            border-color: #444;
        }
        
        body.dark-mode .tab-content {
            background-color: #1e1e1e;
        }
        
        body.dark-mode .tab-button {
            background-color: #0d153a;
        }
        
        body.dark-mode .tab-button:hover {
            background-color: #1a237e;
        }
        
        header {
            background-color: #1a237e;
            color: gold;
            text-align: center;
            padding: 1rem 0;
            border-bottom: 5px solid gold;
            position: relative;
        }
        
        .header-images {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 10px 0;
            flex-wrap: wrap;
        }
        
        .header-images img {
            max-height: 150px;
            border: 2px solid gold;
            border-radius: 5px;
        }
        
        h1 {
            margin: 0;
            font-size: 3rem;
        }
        
        .container {
            max-width: 800px;
            margin: 2rem auto;
            padding: 0 1rem;
            flex: 1;
        }
        
        .page {
            display: none;
            padding: 2rem;
            background-color: white;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }
        
        .page.active {
            display: block;
        }
        
        nav {
            background-color: #1a237e;
            padding: 1rem;
            text-align: center;
        }
        
        nav a {
            color: gold;
            text-decoration: none;
            margin: 0 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            transition: background-color 0.3s;
            display: inline-block;
        }
        
        nav a:hover {
            background-color: #303f9f;
        }
        
        footer {
            background-color: #1a237e;
            color: gold;
            text-align: center;
            padding: 1rem 0;
            margin-top: auto;
            width: 100%;
        }
        
        .page-image {
            max-width: 100%;
            display: block;
            margin: 20px auto;
            border: 2px solid #1a237e;
            border-radius: 5px;
        }
        
        .contact-list {
            list-style-type: none;
            padding: 0;
        }
        
        .contact-list li {
            margin-bottom: 1rem;
            padding: 0.5rem;
            background-color: #f8f8f8;
            border-left: 3px solid #1a237e;
        }
        
        .citizenship-form {
            margin-top: 2rem;
            padding: 1rem;
            background-color: #f0f0f0;
            border-radius: 5px;
        }
        
        .citizenship-form ol {
            padding-left: 1.5rem;
        }
        
        .citizenship-form li {
            margin-bottom: 1rem;
        }
        
        .hero-card {
            margin-bottom: 2rem;
            padding: 1.5rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #f9f9f9;
        }
        
        .hero-title {
            color: #1a237e;
            border-bottom: 2px solid gold;
            padding-bottom: 0.5rem;
        }
        
        .hero-subtitle {
            font-style: italic;
            color: #555;
            margin-top: -0.5rem;
            margin-bottom: 1rem;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —Å–∏—Å—Ç–µ–º—ã –≤–∫–ª–∞–¥–æ–∫ */
        .tabs-container {
            margin-top: 2rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            overflow: hidden;
        }

        .tabs-header {
            display: flex;
            background-color: #1a237e;
            border-bottom: 2px solid gold;
        }

        .tab-button {
            background-color: transparent;
            color: gold;
            border: none;
            padding: 1rem 1.5rem;
            cursor: pointer;
            font-size: 1rem;
            font-family: 'Times New Roman', serif;
            transition: background-color 0.3s;
            flex: 1;
            text-align: center;
        }

        .tab-button:hover {
            background-color: #303f9f;
        }

        .tab-button.active {
            background-color: #0d153a;
            font-weight: bold;
            border-bottom: 3px solid gold;
        }

        .tab-content {
            display: none;
            padding: 1.5rem;
            background-color: white;
        }

        .tab-content.active {
            display: block;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –Ω–∞—É—á–Ω—ã—Ö —Ä–∞–±–æ—Ç */
        .science-intro {
            margin-bottom: 2rem;
            padding-bottom: 2rem;
            border-bottom: 2px solid #1a237e;
        }

        .research-paper {
            line-height: 1.6;
        }

        .research-paper h3, .research-paper h4, .research-paper h5 {
            color: #1a237e;
            margin-top: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .research-paper h3 {
            border-bottom: 2px solid gold;
            padding-bottom: 0.5rem;
        }

        .research-paper ul {
            padding-left: 2rem;
            margin: 1rem 0;
        }

        .research-paper li {
            margin-bottom: 0.5rem;
        }

        .comparative-images {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin: 1.5rem 0;
        }

        /* –£–ª—É—á—à–µ–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –Ω–∞—É–∫–∏ */
        #science .page-image {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 1.5rem auto;
            border: 2px solid #1a237e;
            border-radius: 5px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }
            
            nav a {
                margin: 0.2rem;
                padding: 0.4rem 0.8rem;
                font-size: 0.9rem;
            }
            
            .header-images img {
                max-height: 100px;
            }
            
            .container {
                margin: 1rem auto;
                padding: 0 0.5rem;
            }
            
            .page {
                padding: 1rem;
            }

            /* –ê–¥–∞–ø—Ç–∞—Ü–∏—è –≤–∫–ª–∞–¥–æ–∫ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö */
            .tabs-header {
                flex-direction: column;
            }
            
            .tab-button {
                padding: 0.8rem;
                font-size: 0.9rem;
            }
            
            .tab-content {
                padding: 1rem;
            }
            
            .comparative-images {
                flex-direction: column;
            }
            
            /* –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—è —Ç–µ–º—ã */
            .theme-switcher span {
                margin: 0 5px;
                font-size: 1rem;
            }
            
            /* –ê–¥–∞–ø—Ç–∞—Ü–∏—è –∫–Ω–æ–ø–æ–∫ –≤—Ö–æ–¥–∞ */
            .login-button-container,
            .user-menu {
                top: 10px;
                right: 10px;
            }
            
            .login-button,
            .user-button {
                padding: 8px 15px;
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <!-- –ö–Ω–æ–ø–∫–∞ Log In (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω) -->
    <div class="login-button-container" id="loginButtonContainer">
        <button class="login-button" onclick="showLoginModal()">Log In</button>
    </div>
    
    <!-- –ú–µ–Ω—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞) -->
    <div class="user-menu" id="userMenu">
        <button class="user-button" onclick="toggleUserMenu()">
            <span>üë§</span>
            <span id="userName">User</span>
        </button>
        <div class="dropdown-menu" id="userDropdown">
            <button onclick="showPersonalCabinet()">
                Personal Cabinet
            </button>
            <button onclick="showChat()">
                Live Chat
            </button>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—Ö–æ–¥–∞ -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <button class="close-button" onclick="closeLoginModal()">√ó</button>
            <h2>Imperial Login</h2>
            <form id="loginForm">
                <div class="form-group">
                    <label for="username">Login:</label>
                    <input type="text" id="username" required placeholder="Enter your login">
                </div>
                <div class="form-group">
                    <label for="password">Password:</label>
                    <input type="password" id="password" required placeholder="Enter your password">
                </div>
                <button type="button" class="submit-button" onclick="login()">Enter the Empire</button>
                <div class="error-message" id="loginError">Invalid login or password!</div>
            </form>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞ -->
    <div class="modal" id="personalCabinetModal">
        <div class="modal-content">
            <button class="close-button" onclick="closePersonalCabinet()">√ó</button>
            <h2>Imperial Personal Cabinet</h2>
            <div id="cabinetContent">
                <!-- –ó–¥–µ—Å—å –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ -->
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —á–∞—Ç–∞ -->
    <div class="modal" id="chatModal">
        <div class="modal-content">
            <button class="close-button" onclick="closeChat()">√ó</button>
            <h2>Imperial Live Chat</h2>
            <div class="chat-container">
                <div class="chat-header">
                    <span>Imperial Citizens Chat</span>
                    <span id="onlineCount">Online: 0</span>
                </div>
                <div class="chat-messages" id="chatMessages">
                    <div class="chat-notice">Welcome to the Imperial Chat! Your messages are visible to all authorized citizens.</div>
                </div>
                <div class="chat-input-container">
                    <input type="text" class="chat-input" id="chatInput" placeholder="Type your message..." maxlength="500">
                    <button class="send-button" onclick="sendMessage()">Send</button>
                </div>
            </div>
        </div>
    </div>
    
    <header>
        <h1>Sacred Daniel's Empire</h1>
        <div class="header-images">
            <img src="TBA-SITE/1200px-Flag_of_Spain.webp" alt="Imperial Flag">
            <img src="TBA-SITE/20211209_130933.webp" alt="Imperial Symbol">
            <img src="TBA-SITE/5c8d1d84fcd5694f34ec5a7c122609d0.webp" alt="Imperial Emblem">
        </div>
    </header>
    
    <!-- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–º—ã -->
    <div class="theme-switcher" onclick="toggleTheme()">
        <span>‚òÄÔ∏è</span>
        <span>The Sun Scorching Sinners</span>
        <span>|</span>
        <span>The Night - the Outing of Werewolves</span>
        <span>üåô</span>
    </div>
    
    <nav>
        <a href="#home" onclick="return showPage('home')">Home</a>
        <a href="#about" onclick="return showPage('about')">About Us</a>
        <a href="#history" onclick="return showPage('history')">History</a>
        <a href="#heroes" onclick="return showPage('heroes')">Heroes of the Empire</a>
        <a href="#science" onclick="return showPage('science')">Science of the Empire</a>
        <a href="#codex" onclick="return showPage('codex')">Codex</a>
        <a href="#government" onclick="return showPage('government')">Government</a>
        <a href="#media" onclick="return showPage('media')">Media</a>
        <a href="#contact" onclick="return showPage('contact')">Contact</a>
    </nav>
    
    <div class="container">
        <!-- –í—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å–∞–π—Ç–∞ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π -->
        <div id="home" class="page active">
            <h2>Welcome to Sacred Daniel's Empire</h2>
            <p>The glorious maritime nation under the wise rule of our sacred Emperor.</p>
        </div>
        
        <div id="about" class="page">
            <h2>About Us</h2>
            <p>Sacred Daniel's Empire is a small sovereign state with an absolute monarchy located on the coast, with a strong focus on maritime activities. The country's economy is driven by fishing, trading, shipbuilding, in short - sea is the main reason why this empire is even alive. Its picturesque coastline offers stunning views and opportunities for tourism, attracting visitors from around the world. The culture of the country is deeply rooted in its maritime heritage, with traditional sailing practices and customs celebrated and preserved. Sacred Daniel's Empire is known for its vibrant coastal communities, bustling ports, increased crime rate, wise leaders.</p>
        </div>
        
        <div id="history" class="page">
            <h2>History</h2>
            <img src="TBA-SITE/IMG_20250622_170301.jpg" alt="Historical Document" class="page-image">
            <p>The real location of the empire is unknown but after some skirmishes, myths are saying that its somewhe on South coast of Africa. Empire saved the map of archipelago with its base (black) and fort (red) before leaving it in 1800. Here you can learn the history of the country. <a href="https://docs.google.com/document/d/1iSz32g8wN5WH6trZ8I9tlJhcz8VL54w27zmrCDE2jCM/edit?usp=drivesdk" target="_blank">Read our history document</a></p>
        </div>
        
        <div id="heroes" class="page">
            <h2>Heroes of the Empire</h2>
            <div class="hero-card">
                <h3 class="hero-title">Daniel</h3>
                <h4 class="hero-subtitle">Sacred Emperor</h4>
                <p>The founder and wise ruler of the Empire. Known for his strategic mind and deep connection to the sea.</p>
            </div>
            <div class="hero-card">
                <h3 class="hero-title">Blue_The_Drak</h3>
                <h4 class="hero-subtitle">Nobleman, Dragon Enthusiast</h4>
                <p>Master of naval combat and dragon lore. Protector of the Empire's eastern waters.</p>
            </div>
            <div class="hero-card">
                <h3 class="hero-title">Einar</h3>
                <h4 class="hero-subtitle">Son of the Emperor</h4>
                <p>Heir to the throne, skilled in diplomacy and naval strategy. Continues his father's legacy.</p>
            </div>
            <div class="hero-card">
                <h3 class="hero-title">Otto</h3>
                <h4 class="hero-subtitle">Noble Captain</h4>
                <p>Commanding officer of the Imperial Fleet. Known for his bravery in numerous naval battles.</p>
            </div>
            <div class="hero-card">
                <h3 class="hero-title">Def</h3>
                <h4 class="hero-subtitle">High Inquisitor</h4>
                <p>Keeper of the Empire's laws and traditions. Also an expert fisherman and naval tactician.</p>
            </div>
            <div class="hero-card">
                <h3 class="hero-title">Pairo</h3>
                <h4 class="hero-subtitle">Professor and Scientist</h4>
                <p>Head of the Imperial Research Center. Pioneering marine biology and naval engineering.</p>
            </div>
            <div class="hero-card">
                <h3 class="hero-title">Blue2</h3>
                <h4 class="hero-subtitle">Noble Explorer</h4>
                <p>Brother of Blue_The_Drak, charting unknown waters and discovering new lands for the Empire.</p>
            </div>
        </div>
        
        <div id="science" class="page">
            <h2>Science of the Empire</h2>
            <div class="science-intro">
                <p>The Empire is at the forefront of marine research and scientific discovery. Our scientists have made groundbreaking discoveries in marine biology, oceanography, and naval engineering.</p>
                <img src="TBA-SITE/science_image.jpg" alt="Marine Research" class="page-image">
            </div>
            
            <div class="tabs-container">
                <div class="tabs-header">
                    <button class="tab-button active" onclick="openTab(event, 'tab1')">Marine Biology</button>
                    <button class="tab-button" onclick="openTab(event, 'tab2')">Oceanography</button>
                    <button class="tab-button" onclick="openTab(event, 'tab3')">Naval Engineering</button>
                </div>
                <div id="tab1" class="tab-content active">
                    <h3>Marine Biology Research</h3>
                    <div class="research-paper">
                        <h4>Prophet Daniel Marine Life Research Center</h4>
                        <p>Our premier research facility dedicated to the study of marine ecosystems and deep-sea creatures.</p>
                        
                        <h5>Recent Discoveries:</h5>
                        <ul>
                            <li>New species of bioluminescent cephalopods in the Dark Sea region</li>
                            <li>Giant cartilaginous fishes with unique adaptive features</li>
                            <li>Marine anomalies suggesting undiscovered evolutionary pathways</li>
                        </ul>
                        
                        <h5>Research Focus:</h5>
                        <p>Behavioral ecology of deep-sea predators, adaptation mechanisms in extreme pressure environments, and the biological basis of oceanic gigantism.</p>
                    </div>
                </div>
                <div id="tab2" class="tab-content">
                    <h3>Oceanographic Studies</h3>
                    <div class="research-paper">
                        <h4>Dark Sea Anomaly Research</h4>
                        <p>The Empire has been studying the mysterious Dark Sea region for decades, uncovering its secrets.</p>
                        
                        <h5>Key Findings:</h5>
                        <ul>
                            <li>Unusual thermal currents that defy conventional oceanographic models</li>
                            <li>Magnetic anomalies affecting navigation equipment</li>
                            <li>Unique water chemistry supporting previously unknown ecosystems</li>
                        </ul>
                        
                        <h5>Historical Expeditions:</h5>
                        <p>Our 19th century marine expeditions documented numerous sea monster sightings that are now being re-examined through modern scientific lenses.</p>
                    </div>
                </div>
                <div id="tab3" class="tab-content">
                    <h3>Naval Engineering</h3>
                    <div class="research-paper">
                        <h4>Imperial Shipbuilding Innovations</h4>
                        <p>The Empire combines traditional craftsmanship with cutting-edge technology to build the world's most advanced ships.</p>
                        
                        <h5>Technological Advancements:</h5>
                        <ul>
                            <li>Pressure-resistant hull designs for deep-sea exploration</li>
                            <li>Hybrid sail-engine propulsion systems for optimal efficiency</li>
                            <li>Advanced sonar and detection systems based on marine biology research</li>
                        </ul>
                        
                        <h5>Future Projects:</h5>
                        <p>Development of submersible research vessels capable of reaching previously inaccessible depths of the Dark Sea.</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="codex" class="page">
            <h2>Imperial Codex</h2>
            <p>The laws and traditions that govern our Empire, passed down through generations of wise rulers.</p>
            
            <div class="hero-card">
                <h3 class="hero-title">Fundamental Laws</h3>
                <ol>
                    <li>The Emperor's word is law, guided by wisdom and tradition</li>
                    <li>All citizens must contribute to the Empire's maritime strength</li>
                    <li>Respect for the sea and its creatures is paramount</li>
                    <li>Knowledge and research are valued above all material wealth</li>
                    <li>Loyalty to the Empire and its people is non-negotiable</li>
                </ol>
            </div>
            
            <div class="hero-card">
                <h3 class="hero-title">Maritime Traditions</h3>
                <ul>
                    <li>The Blessing of the Fleet ceremony each spring</li>
                    <li>Annual celebration of the Empire's founding (1700)</li>
                    <li>Traditional sailing races between noble houses</li>
                    <li>Storytelling nights preserving naval history and folklore</li>
                    <li>Scientific symposiums to share new discoveries</li>
                </ul>
            </div>
            
            <div class="hero-card">
                <h3 class="hero-title">Citizenship Rights</h3>
                <ul>
                    <li>Right to maritime education and training</li>
                    <li>Access to Imperial research and discoveries</li>
                    <li>Protection under the Emperor's law</li>
                    <li>Participation in democratic advisory councils</li>
                    <li>Right to pursue scientific inquiry</li>
                </ul>
            </div>
        </div>
        
        <div id="government" class="page">
            <h2>Government Structure</h2>
            <p>The Empire operates under an absolute monarchy with advisory councils representing various interests.</p>
            
            <div class="hero-card">
                <h3 class="hero-title">The Emperor</h3>
                <p><strong>Daniel De Courno</strong> - Sacred Emperor and Supreme Commander</p>
                <p>Final authority on all matters of state, law, and military command.</p>
            </div>
            
            <div class="hero-card">
                <h3 class="hero-title">Royal Council</h3>
                <p>Advisory body consisting of the Empire's most trusted nobles and experts:</p>
                <ul>
                    <li><strong>Einar</strong> - Heir Apparent and Diplomatic Affairs</li>
                    <li><strong>Def</strong> - High Inquisitor and Legal Affairs</li>
                    <li><strong>Pairo</strong> - Scientific Research and Development</li>
                    <li><strong>Otto</strong> - Naval Command and Defense</li>
                    <li><strong>Blue_The_Drak & Blue2</strong> - Exploration and Intelligence</li>
                </ul>
            </div>
            
            <div class="hero-card">
                <h3 class="hero-title">Government Departments</h3>
                <ul>
                    <li><strong>Imperial Navy</strong> - Defense and maritime security</li>
                    <li><strong>Research Institute</strong> - Scientific discovery and innovation</li>
                    <li><strong>Trade Commission</strong> - Economic affairs and commerce</li>
                    <li><strong>Cultural Ministry</strong> - Preservation of traditions and history</li>
                    <li><strong>Exploration Office</strong> - Charting new waters and territories</li>
                </ul>
            </div>
        </div>
        
        <div id="media" class="page">
            <h2>Imperial Media</h2>
            <p>Stay updated with the latest news, announcements, and scientific discoveries from the Empire.</p>
            
            <div class="hero-card">
                <h3 class="hero-title">Recent Announcements</h3>
                <ul>
                    <li><strong>New Research Expedition:</strong> The Prophet Daniel Research Center is launching a new deep-sea exploration mission to the Dark Sea</li>
                    <li><strong>Naval Exercises:</strong> Imperial Fleet conducting joint maneuvers with allied maritime nations</li>
                    <li><strong>Scientific Breakthrough:</strong> Discovery of new marine species with potential medical applications</li>
                    <li><strong>Cultural Event:</strong> Annual Sea Festival scheduled for next month</li>
                </ul>
            </div>
            
            <div class="hero-card">
                <h3 class="hero-title">Imperial Decrees</h3>
                <div class="citizenship-form">
                    <h4>Decree #2024-001</h4>
                    <p>All citizens are encouraged to participate in maritime conservation efforts. The Emperor declares the month of June as "Sea Protection Month."</p>
                    
                    <h4>Decree #2024-002</h4>
                    <p>The Imperial Research Center is granted additional funding for Dark Sea anomaly studies. All findings to be shared with citizen scientists.</p>
                    
                    <h4>Decree #2024-003</h4>
                    <p>New trade agreements established with neighboring maritime states. Imperial exports of naval technology and research to increase by 30%.</p>
                </div>
            </div>
            
            <div class="hero-card">
                <h3 class="hero-title">Historical Archives</h3>
                <p>Access to digital copies of historical documents, expedition logs, and scientific papers:</p>
                <ul>
                    <li><a href="https://docs.google.com/document/d/1iSz32g8wN5WH6trZ8I9tlJhcz8VL54w27zmrCDE2jCM/edit?usp=drivesdk" target="_blank">Complete History of the Empire</a></li>
                    <li><a href="#" onclick="return false">19th Century Expedition Logs</a></li>
                    <li><a href="#" onclick="return false">Marine Biology Research Papers</a></li>
                    <li><a href="#" onclick="return false">Naval Battle Chronicles</a></li>
                </ul>
            </div>
        </div>
        
        <div id="contact" class="page">
            <h2>Contact the Empire</h2>
            <p>For official inquiries, research collaborations, or citizenship information.</p>
            
            <div class="contact-list">
                <li>
                    <strong>Imperial Office</strong><br>
                    Official communications and state matters<br>
                    Email: imperial.office@sacred-empire.dn
                </li>
                <li>
                    <strong>Research Center</strong><br>
                    Scientific inquiries and collaboration<br>
                    Email: research@prophet-daniel-center.dn
                </li>
                <li>
                    <strong>Naval Command</strong><br>
                    Military and defense matters<br>
                    Email: naval.command@imperial-fleet.dn
                </li>
                <li>
                    <strong>Citizenship Bureau</strong><br>
                    Applications and citizen services<br>
                    Email: citizenship@imperial-services.dn
                </li>
            </div>
            
            <div class="citizenship-form">
                <h3>Apply for Imperial Citizenship</h3>
                <p>The Empire welcomes dedicated individuals who share our values of knowledge, maritime tradition, and scientific pursuit.</p>
                
                <h4>Requirements:</h4>
                <ol>
                    <li>Commitment to the Empire's laws and traditions</li>
                    <li>Willingness to contribute to maritime activities</li>
                    <li>Respect for scientific inquiry and knowledge</li>
                    <li>Clean record and good standing</li>
                    <li>Basic understanding of naval traditions</li>
                </ol>
                
                <p><em>Note: Current citizenship applications are being processed through the official channels listed above. The online application system is under development.</em></p>
            </div>
        </div>
        
    </div>
    
    <footer>
        &copy; 1700 Sacred Daniel's Empire. All rights reserved.
    </footer>
    
    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Firebase (–¥–æ–±–∞–≤–ª–µ–Ω–æ)
        const firebaseConfig = {
            apiKey: "AIzaSyCOXWodWpE4KdEW1zwryydQUjfxHPiS-3E",
            authDomain: "sacred-empire-chat.firebaseapp.com",
            databaseURL: "https://sacred-empire-chat-default-rtdb.firebaseio.com",
            projectId: "sacred-empire-chat",
            storageBucket: "sacred-empire-chat.firebasestorage.app",
            messagingSenderId: "131630929373",
            appId: "1:131630929373:web:d4208575c65f0df4525234"
        };
        
        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ Firebase (–¥–æ–±–∞–≤–ª–µ–Ω–æ)
        let firebaseApp;
        let database;
        let chatRef;
        let usersRef;
        let isFirebaseConnected = false;

        // –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–≤—Å–µ –∞–∫–∫–∞—É–Ω—Ç—ã)
        const users = {
            'emp123dan': {
                password: 'Lyusek2020',
                name: 'Daniel',
                bio: 'sacred emperor, writer'
            },
            'blueisthebestcolor': {
                password: '123blue123',
                name: 'Blue_The_Drak',
                bio: 'nobleman, loves dragons'
            },
            'theemperorsson': {
                password: 'vikings123power',
                name: 'Einar',
                bio: 'nobleman of the royal blood'
            },
            'ottobutnotottoman': {
                password: 'verdeilineverde',
                name: 'Otto',
                bio: 'nobleman, captain'
            },
            'defenseqwerty': {
                password: '123church123',
                name: 'Def',
                bio: 'nobleman, lucky, high inquisitor, loves fishing'
            },
            'pyroorpairo': {
                password: 'iguesspairo123',
                name: 'Pairo',
                bio: 'professor, scientist'
            },
            'bluebecauseblue': {
                password: 'notthedragons123',
                name: 'Blue2',
                bio: 'the brother of other Blue, nobleman, explorer'
            }
        };

        // –¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
        let currentUser = null;
        
        // –°–ø–∏—Å–æ–∫ –æ–Ω–ª–∞–π–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (—Å–∏–º—É–ª—è—Ü–∏—è)
        let onlineUsers = new Set();
        
        // –°–æ–æ–±—â–µ–Ω–∏—è —á–∞—Ç–∞ (—Å–∏–º—É–ª—è—Ü–∏—è –æ–±—â–µ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞)
        let chatMessages = [];
        
        // ID —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏ (–¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∫—Ç–æ –æ–Ω–ª–∞–π–Ω)
        let sessionId = Math.random().toString(36).substring(2);

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase (–¥–æ–±–∞–≤–ª–µ–Ω–æ)
        function initFirebase() {
            try {
                firebaseApp = firebase.initializeApp(firebaseConfig);
                database = firebase.database();
                isFirebaseConnected = true;
                console.log("Firebase initialized successfully");
                return true;
            } catch (error) {
                console.error("Firebase initialization error:", error);
                return false;
            }
        }

        // –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —á–∞—Ç—É Firebase (–¥–æ–±–∞–≤–ª–µ–Ω–æ)
        function connectToFirebaseChat() {
            if (!isFirebaseConnected || !currentUser) return;
            
            try {
                chatRef = database.ref('chat/messages');
                usersRef = database.ref('chat/users');
                
                // –°–ª—É—à–∞–µ–º –Ω–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
                chatRef.limitToLast(100).on('value', (snapshot) => {
                    const messages = snapshot.val() || {};
                    updateFirebaseChatDisplay(messages);
                });
                
                // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –æ–Ω–ª–∞–π–Ω
                const userOnlineRef = usersRef.child(currentUser.username);
                userOnlineRef.set({
                    name: currentUser.name,
                    online: true,
                    lastSeen: firebase.database.ServerValue.TIMESTAMP
                });
                
                // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è
                userOnlineRef.onDisconnect().update({
                    online: false,
                    lastSeen: firebase.database.ServerValue.TIMESTAMP
                });
                
                return true;
            } catch (error) {
                console.error("Firebase chat connection error:", error);
                return false;
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —á–∞—Ç–∞ Firebase (–¥–æ–±–∞–≤–ª–µ–Ω–æ)
        function updateFirebaseChatDisplay(messages) {
            const chatMessagesElement = document.getElementById('chatMessages');
            if (!chatMessagesElement) return;
            
            // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –æ–±—ä–µ–∫—Ç –≤ –º–∞—Å—Å–∏–≤ –∏ —Å–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –≤—Ä–µ–º–µ–Ω–∏
            const messagesArray = Object.values(messages).sort((a, b) => a.timestamp - b.timestamp);
            
            // –û—á–∏—â–∞–µ–º –∏ –¥–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è
            chatMessagesElement.innerHTML = '';
            
            if (messagesArray.length === 0) {
                chatMessagesElement.innerHTML = '<div class="chat-notice">Welcome to the Imperial Chat! Your messages are visible to all authorized citizens.</div>';
            } else {
                messagesArray.forEach(msg => {
                    const messageDiv = document.createElement('div');
                    
                    if (msg.type === 'system') {
                        messageDiv.className = 'message system-message';
                        messageDiv.innerHTML = `
                            <div class="message-content">${msg.text}</div>
                            <div class="message-time">${msg.time}</div>
                        `;
                    } else {
                        messageDiv.className = 'message';
                        messageDiv.innerHTML = `
                            <div class="message-header">
                                <span class="message-user">${msg.user}</span>
                                <span class="message-time">${msg.time}</span>
                            </div>
                            <div class="message-content">${msg.text}</div>
                        `;
                    }
                    
                    chatMessagesElement.appendChild(messageDiv);
                });
            }
            
            // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –≤–Ω–∏–∑
            setTimeout(() => {
                chatMessagesElement.scrollTop = chatMessagesElement.scrollHeight;
            }, 100);
        }

        // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ Firebase (–¥–æ–±–∞–≤–ª–µ–Ω–æ)
        function sendFirebaseMessage(messageText) {
            if (!isFirebaseConnected || !currentUser || !chatRef) return false;
            
            try {
                const message = {
                    user: currentUser.name,
                    text: messageText,
                    time: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}),
                    timestamp: Date.now(),
                    type: 'user',
                    userId: currentUser.username
                };
                
                chatRef.push(message);
                return true;
            } catch (error) {
                console.error("Error sending Firebase message:", error);
                return false;
            }
        }

        // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ Firebase (–¥–æ–±–∞–≤–ª–µ–Ω–æ)
        function sendFirebaseSystemMessage(text) {
            if (!isFirebaseConnected || !chatRef) return;
            
            try {
                const message = {
                    user: 'Imperial System',
                    text: text,
                    time: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}),
                    timestamp: Date.now(),
                    type: 'system'
                };
                
                chatRef.push(message);
            } catch (error) {
                console.error("Error sending Firebase system message:", error);
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –≤—Ö–æ–¥–∞
        function showLoginModal() {
            document.getElementById('loginModal').classList.add('active');
            document.getElementById('loginError').style.display = 'none';
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
            setTimeout(() => {
                document.getElementById('username').focus();
            }, 100);
        }

        // –§—É–Ω–∫—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∏—è –æ–∫–Ω–∞ –≤—Ö–æ–¥–∞
        function closeLoginModal() {
            document.getElementById('loginModal').classList.remove('active');
        }

        // –§—É–Ω–∫—Ü–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (–æ–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–ª—è Firebase)
        function login() {
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value;
            const errorElement = document.getElementById('loginError');
            
            if (users[username] && users[username].password === password) {
                // –£—Å–ø–µ—à–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
                currentUser = {
                    username: username,
                    ...users[username]
                };
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                localStorage.setItem('sessionId', sessionId);
                
                // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –æ–Ω–ª–∞–π–Ω
                addUserToOnline();
                
                // –ó–∞–∫—Ä—ã–≤–∞–µ–º –æ–∫–Ω–æ –≤—Ö–æ–¥–∞
                closeLoginModal();
                
                // –ú–µ–Ω—è–µ–º –∫–Ω–æ–ø–∫—É Log In –Ω–∞ –º–µ–Ω—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                document.getElementById('loginButtonContainer').style.display = 'none';
                document.getElementById('userMenu').classList.add('active');
                document.getElementById('userName').textContent = currentUser.name;
                
                // –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ Firebase —á–∞—Ç—É –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–æ—à–µ–ª
                if (isFirebaseConnected) {
                    connectToFirebaseChat();
                    sendFirebaseSystemMessage(`${currentUser.name} has entered the Imperial Chat. Long live the Empire!`);
                } else {
                    // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–π —á–∞—Ç –∫–∞–∫ fallback
                    addSystemMessage(`${currentUser.name} has entered the Imperial Chat. Long live the Empire!`);
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –æ–Ω–ª–∞–π–Ω
                updateOnlineCount();
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–º –≤—Ö–æ–¥–µ
                showNotification(`Welcome to the Empire, ${currentUser.name}!`);
            } else {
                // –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                errorElement.style.display = 'block';
                document.getElementById('username').style.borderColor = '#ff4444';
                document.getElementById('password').style.borderColor = '#ff4444';
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –æ–Ω–ª–∞–π–Ω
        function addUserToOnline() {
            if (currentUser) {
                const userKey = `${currentUser.username}_${sessionId}`;
                onlineUsers.add(userKey);
                saveOnlineUsers();
            }
        }

        // –§—É–Ω–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –æ–Ω–ª–∞–π–Ω
        function removeUserFromOnline() {
            if (currentUser) {
                const userKey = `${currentUser.username}_${sessionId}`;
                onlineUsers.delete(userKey);
                saveOnlineUsers();
            }
        }

        // –§—É–Ω–∫—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–Ω–ª–∞–π–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        function saveOnlineUsers() {
            localStorage.setItem('onlineUsers', JSON.stringify(Array.from(onlineUsers)));
            updateOnlineCount();
        }

        // –§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –æ–Ω–ª–∞–π–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        function loadOnlineUsers() {
            try {
                const saved = localStorage.getItem('onlineUsers');
                if (saved) {
                    const usersArray = JSON.parse(saved);
                    onlineUsers = new Set(usersArray);
                    
                    // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ —Å–µ—Å—Å–∏–∏ (—Å—Ç–∞—Ä—à–µ 5 –º–∏–Ω—É—Ç)
                    const now = Date.now();
                    const fiveMinutesAgo = now - 5 * 60 * 1000;
                    
                    Array.from(onlineUsers).forEach(userKey => {
                        const parts = userKey.split('_');
                        if (parts.length > 1) {
                            // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –≤—Ä–µ–º–µ–Ω–∏ —Å–µ—Å—Å–∏–∏
                            // –ü–æ–∫–∞ –ø—Ä–æ—Å—Ç–æ –æ—Å—Ç–∞–≤–ª—è–µ–º –≤—Å–µ—Ö
                        }
                    });
                }
            } catch (e) {
                console.log('Error loading online users:', e);
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—á–µ—Ç—á–∏–∫–∞ –æ–Ω–ª–∞–π–Ω
        function updateOnlineCount() {
            const onlineCount = document.getElementById('onlineCount');
            if (onlineCount) {
                const count = onlineUsers.size;
                onlineCount.textContent = `Online: ${count}`;
                
                // –¢–∞–∫–∂–µ –æ–±–Ω–æ–≤–ª—è–µ–º –≤ localStorage –¥–ª—è –¥—Ä—É–≥–∏—Ö –≤–∫–ª–∞–¥–æ–∫
                localStorage.setItem('lastOnlineUpdate', Date.now().toString());
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
        function addSystemMessage(text) {
            const message = {
                id: Date.now().toString(),
                user: 'Imperial System',
                text: text,
                time: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}),
                timestamp: Date.now(),
                type: 'system'
            };
            
            addMessageToChat(message);
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –æ–±—ã—á–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
        function addUserMessage(text, user) {
            const message = {
                id: Date.now().toString(),
                user: user,
                text: text,
                time: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}),
                timestamp: Date.now(),
                type: 'user'
            };
            
            addMessageToChat(message);
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —á–∞—Ç
        function addMessageToChat(message) {
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
            loadChatMessages();
            
            // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            chatMessages.push(message);
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
            saveChatMessages();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –µ—Å–ª–∏ —á–∞—Ç –æ—Ç–∫—Ä—ã—Ç
            if (document.getElementById('chatModal').classList.contains('active')) {
                updateChatDisplay();
            }
        }

        // –§—É–Ω–∫—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π —á–∞—Ç–∞
        function saveChatMessages() {
            try {
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å–æ–æ–±—â–µ–Ω–∏–π
                const messagesToSave = chatMessages.slice(-100);
                localStorage.setItem('chatMessages', JSON.stringify(messagesToSave));
            } catch (e) {
                console.log('Error saving chat messages:', e);
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π —á–∞—Ç–∞
        function loadChatMessages() {
            try {
                const saved = localStorage.getItem('chatMessages');
                if (saved) {
                    chatMessages = JSON.parse(saved);
                }
            } catch (e) {
                console.log('Error loading chat messages:', e);
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
        function checkForNewMessages() {
            if (currentUser && document.getElementById('chatModal').classList.contains('active')) {
                loadChatMessages();
                updateChatDisplay();
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ–Ω—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function toggleUserMenu() {
            const dropdown = document.getElementById('userDropdown');
            dropdown.classList.toggle('active');
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–µ–Ω—é –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
        document.addEventListener('click', function(event) {
            const userMenu = document.getElementById('userMenu');
            const userButton = userMenu.querySelector('.user-button');
            const dropdown = document.getElementById('userDropdown');
            
            if (userMenu.classList.contains('active') && 
                !userButton.contains(event.target) && 
                !dropdown.contains(event.target)) {
                dropdown.classList.remove('active');
            }
        });

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞
        function showPersonalCabinet() {
            document.getElementById('userDropdown').classList.remove('active');
            
            const cabinetContent = document.getElementById('cabinetContent');
            
            if (currentUser) {
                cabinetContent.innerHTML = `
                    <div class="profile-info">
                        <h3>Imperial Citizen Profile</h3>
                        <p><strong>Login:</strong> ${currentUser.username}</p>
                        <p><strong>Name:</strong> ${currentUser.name}</p>
                        <p><strong>Bio:</strong> ${currentUser.bio}</p>
                        <p><strong>Status:</strong> Verified Citizen of the Empire</p>
                        <p><strong>Chat Name:</strong> ${currentUser.name} (shown in chat)</p>
                    </div>
                    <button class="logout-button" onclick="logout()">Logout from Empire</button>
                `;
            }
            
            document.getElementById('personalCabinetModal').classList.add('active');
        }

        // –§—É–Ω–∫—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∏—è –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞
        function closePersonalCabinet() {
            document.getElementById('personalCabinetModal').classList.remove('active');
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ —á–∞—Ç–∞ (–æ–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–ª—è Firebase)
        function showChat() {
            document.getElementById('userDropdown').classList.remove('active');
            
            if (currentUser) {
                // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ–Ω–ª–∞–π–Ω
                loadChatMessages();
                loadOnlineUsers();
                updateOnlineCount();
                
                // –û—Ç–∫—Ä—ã–≤–∞–µ–º —á–∞—Ç
                document.getElementById('chatModal').classList.add('active');
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                if (isFirebaseConnected && chatRef) {
                    // –ò—Å–ø–æ–ª—å–∑—É–µ–º Firebase —á–∞—Ç
                    // –°–æ–æ–±—â–µ–Ω–∏—è —É–∂–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ —Å–ª—É—à–∞—Ç–µ–ª—å
                } else {
                    // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–π —á–∞—Ç
                    updateChatDisplay();
                }
                
                // –§–æ–∫—É—Å–∏—Ä—É–µ–º—Å—è –Ω–∞ –ø–æ–ª–µ –≤–≤–æ–¥–∞
                setTimeout(() => {
                    document.getElementById('chatInput').focus();
                    const chatMessagesElement = document.getElementById('chatMessages');
                    chatMessagesElement.scrollTop = chatMessagesElement.scrollHeight;
                }, 100);
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∏—è —á–∞—Ç–∞
        function closeChat() {
            document.getElementById('chatModal').classList.remove('active');
            document.getElementById('chatInput').value = '';
        }

        // –§—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è (–æ–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–ª—è Firebase)
        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (message && currentUser) {
                // –ü—Ä–æ–±—É–µ–º –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —á–µ—Ä–µ–∑ Firebase
                if (isFirebaseConnected) {
                    const sent = sendFirebaseMessage(message);
                    if (!sent) {
                        // –ï—Å–ª–∏ Firebase –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª, –∏—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–π —á–∞—Ç
                        addUserMessage(message, currentUser.name);
                    }
                } else {
                    // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–π —á–∞—Ç
                    addUserMessage(message, currentUser.name);
                }
                
                // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞
                input.value = '';
                
                // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –≤–Ω–∏–∑
                const chatMessagesElement = document.getElementById('chatMessages');
                chatMessagesElement.scrollTop = chatMessagesElement.scrollHeight;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —á–∞—Ç–∞)
                if (!isFirebaseConnected) {
                    updateChatDisplay();
                }
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —á–∞—Ç–∞
        function updateChatDisplay() {
            const chatMessagesElement = document.getElementById('chatMessages');
            
            // –û—á–∏—â–∞–µ–º –∏ –¥–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è
            chatMessagesElement.innerHTML = '';
            
            if (chatMessages.length === 0) {
                chatMessagesElement.innerHTML = '<div class="chat-notice">Welcome to the Imperial Chat! Your messages are visible to all authorized citizens.</div>';
            } else {
                chatMessages.forEach(msg => {
                    const messageDiv = document.createElement('div');
                    
                    if (msg.type === 'system') {
                        messageDiv.className = 'message system-message';
                        messageDiv.innerHTML = `
                            <div class="message-content">${msg.text}</div>
                            <div class="message-time">${msg.time}</div>
                        `;
                    } else {
                        messageDiv.className = 'message';
                        messageDiv.innerHTML = `
                            <div class="message-header">
                                <span class="message-user">${msg.user}</span>
                                <span class="message-time">${msg.time}</span>
                            </div>
                            <div class="message-content">${msg.text}</div>
                        `;
                    }
                    
                    chatMessagesElement.appendChild(messageDiv);
                });
            }
            
            // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –≤–Ω–∏–∑
            chatMessagesElement.scrollTop = chatMessagesElement.scrollHeight;
        }

        // –§—É–Ω–∫—Ü–∏—è –≤—ã—Ö–æ–¥–∞ (–æ–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–ª—è Firebase)
        function logout() {
            if (currentUser) {
                // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –≤—ã—Ö–æ–¥–µ
                if (isFirebaseConnected) {
                    sendFirebaseSystemMessage(`${currentUser.name} has left the Imperial Chat.`);
                } else {
                    addSystemMessage(`${currentUser.name} has left the Imperial Chat.`);
                }
                
                // –£–¥–∞–ª—è–µ–º –∏–∑ –æ–Ω–ª–∞–π–Ω
                removeUserFromOnline();
            }
            
            currentUser = null;
            localStorage.removeItem('currentUser');
            
            // –ú–µ–Ω—è–µ–º –º–µ–Ω—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ –∫–Ω–æ–ø–∫—É Log In
            document.getElementById('userMenu').classList.remove('active');
            document.getElementById('loginButtonContainer').style.display = 'block';
            document.getElementById('userDropdown').classList.remove('active');
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞
            closePersonalCabinet();
            closeChat();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –≤—ã—Ö–æ–¥–µ
            showNotification('You have left the Empire. Until we meet again!');
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function showNotification(message) {
            // –ü—Ä–æ—Å—Ç–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ alert
            alert(message);
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        function showPage(pageId) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            const pages = document.querySelectorAll('.page');
            pages.forEach(page => {
                page.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
            document.getElementById(pageId).classList.add('active');
            
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—ã–ø–∞–¥–∞—é—â–µ–µ –º–µ–Ω—é
            const dropdown = document.getElementById('userDropdown');
            if (dropdown) dropdown.classList.remove('active');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º URL –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            history.pushState(null, null, `#${pageId}`);
            
            return false;
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞–±–æ—Ç—ã –≤–∫–ª–∞–¥–æ–∫ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –Ω–∞—É–∫–∏
        function openTab(evt, tabName) {
            // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Å –∫–ª–∞—Å—Å–æ–º "tab-content" –∏ —Å–∫—Ä—ã–≤–∞–µ–º –∏—Ö
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(tab => {
                tab.classList.remove('active');
            });
            
            // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Å –∫–ª–∞—Å—Å–æ–º "tab-button" –∏ —É–¥–∞–ª—è–µ–º –∫–ª–∞—Å—Å "active"
            const tabButtons = document.querySelectorAll('.tab-button');
            tabButtons.forEach(button => {
                button.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–µ–∫—É—â—É—é –≤–∫–ª–∞–¥–∫—É –∏ –¥–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å "active" –∫ –∫–Ω–æ–ø–∫–µ
            document.getElementById(tabName).classList.add('active');
            evt.currentTarget.classList.add('active');
            
            // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
            evt.preventDefault();
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã
        function toggleTheme() {
            const body = document.body;
            const themeSwitcher = document.querySelector('.theme-switcher');
            
            if (body.classList.contains('dark-mode')) {
                // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º –Ω–∞ —Å–≤–µ—Ç–ª—É—é —Ç–µ–º—É
                body.classList.remove('dark-mode');
                themeSwitcher.innerHTML = '<span>‚òÄÔ∏è</span><span>The Sun Scorching Sinners</span><span>|</span><span>The Night - the Outing of Werewolves</span><span>üåô</span>';
                localStorage.setItem('theme', 'light');
            } else {
                // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º –Ω–∞ —Ç–µ–º–Ω—É—é —Ç–µ–º—É
                body.classList.add('dark-mode');
                themeSwitcher.innerHTML = '<span>üåô</span><span>The Night - the Outing of Werewolves</span><span>|</span><span>The Sun Scorching Sinners</span><span>‚òÄÔ∏è</span>';
                localStorage.setItem('theme', 'dark');
            }
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏—è Enter –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞ —á–∞—Ç–∞
        document.getElementById('chatInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏—è Enter –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞ –ª–æ–≥–∏–Ω–∞
        document.getElementById('password').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                login();
            }
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–æ–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–ª—è Firebase)
        document.addEventListener('DOMContentLoaded', function() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Firebase
            initFirebase();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                document.getElementById('loginButtonContainer').style.display = 'none';
                document.getElementById('userMenu').classList.add('active');
                document.getElementById('userName').textContent = currentUser.name;
                
                // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –æ–Ω–ª–∞–π–Ω
                sessionId = localStorage.getItem('sessionId') || sessionId;
                addUserToOnline();
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è —á–∞—Ç–∞
                loadChatMessages();
                
                // –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ Firebase —á–∞—Ç—É –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–æ—à–µ–ª
                if (isFirebaseConnected) {
                    connectToFirebaseChat();
                }
            }
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –æ–Ω–ª–∞–π–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            loadOnlineUsers();
            updateOnlineCount();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é —Ç–µ–º—É
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.body.classList.add('dark-mode');
                const themeSwitcher = document.querySelector('.theme-switcher');
                themeSwitcher.innerHTML = '<span>üåô</span><span>The Night - the Outing of Werewolves</span><span>|</span><span>The Sun Scorching Sinners</span><span>‚òÄÔ∏è</span>';
            }
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ö—ç—à–∞ –≤ URL –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            const hash = window.location.hash.substring(1);
            if (hash && document.getElementById(hash)) {
                showPage(hash);
            } else {
                showPage('home');
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤–∫–ª–∞–¥–æ–∫ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –Ω–∞—É–∫–∏
            if (document.getElementById('tab1')) {
                document.getElementById('tab1').classList.add('active');
            }
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –∏—Ö
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                modal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        this.classList.remove('active');
                        if (this.id === 'loginModal') {
                            closeLoginModal();
                        }
                    }
                });
            });
            
            // –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–Ω–ª–∞–π–Ω —Å—Ç–∞—Ç—É—Å–∞
            setInterval(() => {
                if (currentUser) {
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–≤–æ–π –æ–Ω–ª–∞–π–Ω —Å—Ç–∞—Ç—É—Å
                    addUserToOnline();
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —á–∞—Ç–∞)
                    if (!isFirebaseConnected) {
                        checkForNewMessages();
                    }
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –æ–Ω–ª–∞–π–Ω
                    updateOnlineCount();
                    
                    // –û—á–∏—â–∞–µ–º —Å—Ç–∞—Ä—ã–µ —Å–µ—Å—Å–∏–∏
                    loadOnlineUsers();
                }
            }, 30000); // –ö–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
        });

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –ø–æ –∏—Å—Ç–æ—Ä–∏–∏ –±—Ä–∞—É–∑–µ—Ä–∞
        window.addEventListener('popstate', function() {
            const hash = window.location.hash.substring(1);
            if (hash && document.getElementById(hash)) {
                showPage(hash);
            } else {
                showPage('home');
            }
        });
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –æ–∫–Ω–∞/–≤–∫–ª–∞–¥–∫–∏
        window.addEventListener('beforeunload', function() {
            if (currentUser) {
                removeUserFromOnline();
            }
        });
    </script>
</body>
</html>
