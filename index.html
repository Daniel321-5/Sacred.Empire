<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sacred Daniel's Empire | Maritime Kingdom Since 1700 | –ú–æ—Ä—Å–∫–∞—è –ò–º–ø–µ—Ä–∏—è</title>
    <!-- –û—Å—Ç–∞–ª—å–Ω—ã–µ –º–µ—Ç–∞—Ç–µ–≥–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π -->
    
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º Firebase -->
   <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <style>
        /* –í—Å–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –∫–∞–∫ –±—ã–ª–∏, —Ç–æ–ª—å–∫–æ –¥–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ –¥–ª—è —á–∞—Ç–∞ */
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π */
        .notification {
            position: fixed;
            top: 80px;
            right: 20px;
            background-color: #4caf50;
            color: white;
            padding: 15px;
            border-radius: 5px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            z-index: 3000;
            display: none;
            max-width: 300px;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .notification.error {
            background-color: #f44336;
        }
        
        .notification.info {
            background-color: #2196f3;
        }
        
        .chat-status {
            font-size: 0.9em;
            color: #90caf9;
        }
        
        .chat-status.connected {
            color: #81c784;
        }
        
        .chat-status.disconnected {
            color: #e57373;
        }
        
        .typing-indicator {
            font-style: italic;
            color: #666;
            padding: 5px 10px;
            font-size: 0.9em;
            display: none;
        }
        
        body.dark-mode .typing-indicator {
            color: #aaa;
        }
        
        .message.user-message {
            background-color: #e8f5e9;
            border-left-color: #4caf50;
            margin-left: 20px;
        }
        
        body.dark-mode .message.user-message {
            background-color: #1b5e20;
            border-left-color: #81c784;
        }
        
        .message.other-message {
            background-color: #e3f2fd;
            border-left-color: #2196f3;
            margin-right: 20px;
        }
        
        body.dark-mode .message.other-message {
            background-color: #0d47a1;
            border-left-color: #64b5f6;
        }
        
        /* –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π */
        
    </style>
</head>
<body>
    <!-- –í—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –æ—Å—Ç–∞—é—Ç—Å—è –∫–∞–∫ –±—ã–ª–∏ -->
    
    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Firebase (–∑–∞–º–µ–Ω–∏ –Ω–∞ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ)
        const firebaseConfig = {
            apiKey: "AIzaSyCOXWodWpE4KdEW1zwryydQUjfxHPiS-3E",
            authDomain: "sacred-empire-chat.firebaseapp.com",
            databaseURL: "https://sacred-empire-chat-default-rtdb.firebaseio.com",
            projectId: "sacred-empire-chat",
            storageBucket: "sacred-empire-chat.firebasestorage.app",
            messagingSenderId: "131630929373",
            appId: "1:131630929373:web:d4208575c65f0df4525234"
        };
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Firebase
        let firebaseApp;
        let database;
        let chatRef;
        let usersRef;
        let typingRef;
        let currentUserTypingRef;
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase
        function initFirebase() {
            try {
                firebaseApp = firebase.initializeApp(firebaseConfig);
                database = firebase.database();
                console.log("Firebase initialized successfully");
                return true;
            } catch (error) {
                console.error("Firebase initialization error:", error);
                showNotification("Chat service temporarily unavailable. Using local chat.", "error");
                return false;
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function showNotification(message, type = "info") {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }
        
        // –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–≤—Å–µ –∞–∫–∫–∞—É–Ω—Ç—ã)
        const users = {
            'emp123dan': {
                password: 'Lyusek2020',
                name: 'Daniel',
                bio: 'sacred emperor, writer'
            },
            'blueisthebestcolor': {
                password: '123blue123',
                name: 'Blue_The_Drak',
                bio: 'nobleman, loves dragons'
            },
            'theemperorsson': {
                password: 'vikings123power',
                name: 'Einar',
                bio: 'nobleman of the royal blood'
            },
            'ottobutnotottoman': {
                password: 'verdeilineverde',
                name: 'Otto',
                bio: 'nobleman, captain'
            },
            'defenseqwerty': {
                password: '123church123',
                name: 'Def',
                bio: 'nobleman, lucky, high inquisitor, loves fishing'
            },
            'pyroorpairo': {
                password: 'iguesspairo123',
                name: 'Pairo',
                bio: 'professor, scientist'
            },
            'bluebecauseblue': {
                password: 'notthedragons123',
                name: 'Blue2',
                bio: 'the brother of other Blue, nobleman, explorer'
            }
        };
        
        // –¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
        let currentUser = null;
        let isChatConnected = false;
        let lastTypingTime = 0;
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Firebase
            const firebaseInitialized = initFirebase();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                document.getElementById('loginButtonContainer').style.display = 'none';
                document.getElementById('userMenu').classList.add('active');
                document.getElementById('userName').textContent = currentUser.name;
                
                // –ï—Å–ª–∏ Firebase –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω, –ø–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ —á–∞—Ç—É
                if (firebaseInitialized && currentUser) {
                    connectToChat();
                }
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é —Ç–µ–º—É
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.body.classList.add('dark-mode');
                const themeSwitcher = document.querySelector('.theme-switcher');
                themeSwitcher.innerHTML = '<span>üåô</span><span>The Night - the Outing of Werewolves</span><span>|</span><span>The Sun Scorching Sinners</span><span>‚òÄÔ∏è</span>';
            }
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ö—ç—à–∞ –≤ URL –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            const hash = window.location.hash.substring(1);
            if (hash && document.getElementById(hash)) {
                showPage(hash);
            } else {
                showPage('home');
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤–∫–ª–∞–¥–æ–∫ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –Ω–∞—É–∫–∏
            if (document.getElementById('tab1')) {
                document.getElementById('tab1').classList.add('active');
            }
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –∏—Ö
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                modal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        this.classList.remove('active');
                        if (this.id === 'loginModal') {
                            closeLoginModal();
                        }
                    }
                });
            });
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ –≤ –ø–æ–ª–µ —á–∞—Ç–∞ –¥–ª—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –Ω–∞–±–æ—Ä–∞
            const chatInput = document.getElementById('chatInput');
            if (chatInput) {
                chatInput.addEventListener('input', function() {
                    updateTypingStatus();
                });
            }
        });
        
        // –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —á–∞—Ç—É Firebase
        function connectToChat() {
            if (!database || !currentUser) return;
            
            try {
                // –°–æ–∑–¥–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –¥–ª—è —Å–µ—Å—Å–∏–∏
                const sessionId = Date.now().toString(36) + Math.random().toString(36).substr(2);
                localStorage.setItem('chatSessionId', sessionId);
                
                // –°—Å—ã–ª–∫–∏ –Ω–∞ –¥–∞–Ω–Ω—ã–µ Firebase
                chatRef = database.ref('chat/messages');
                usersRef = database.ref('chat/users');
                typingRef = database.ref('chat/typing');
                currentUserTypingRef = typingRef.child(currentUser.username);
                
                // –°–ª—É—à–∞–µ–º –Ω–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
                chatRef.limitToLast(100).on('value', (snapshot) => {
                    const messages = snapshot.val() || {};
                    updateChatDisplay(messages);
                });
                
                // –°–ª—É—à–∞–µ–º —Å—Ç–∞—Ç—É—Å –Ω–∞–±–æ—Ä–∞ —Ç–µ–∫—Å—Ç–∞
                typingRef.on('value', (snapshot) => {
                    const typingUsers = snapshot.val() || {};
                    updateTypingIndicator(typingUsers);
                });
                
                // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –æ–Ω–ª–∞–π–Ω
                const userOnlineRef = usersRef.child(currentUser.username);
                userOnlineRef.set({
                    name: currentUser.name,
                    online: true,
                    lastSeen: firebase.database.ServerValue.TIMESTAMP
                });
                
                // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è
                userOnlineRef.onDisconnect().update({
                    online: false,
                    lastSeen: firebase.database.ServerValue.TIMESTAMP
                });
                
                // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –Ω–∞–±–æ—Ä–∞
                currentUserTypingRef.onDisconnect().remove();
                
                isChatConnected = true;
                updateChatStatus(true);
                showNotification("Connected to Imperial Chat", "info");
                
                // –î–æ–±–∞–≤–ª—è–µ–º —Å–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –≤—Ö–æ–¥–µ
                sendSystemMessage(`${currentUser.name} has entered the Imperial Chat`);
                
            } catch (error) {
                console.error("Chat connection error:", error);
                showNotification("Failed to connect to chat. Using local mode.", "error");
                isChatConnected = false;
                updateChatStatus(false);
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —á–∞—Ç–∞
        function updateChatStatus(connected) {
            const onlineCount = document.getElementById('onlineCount');
            if (onlineCount) {
                onlineCount.innerHTML = connected ? 
                    '<span class="chat-status connected">‚óè Connected</span>' : 
                    '<span class="chat-status disconnected">‚óè Offline</span>';
            }
        }
        
        // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
        function sendSystemMessage(text) {
            if (!database || !isChatConnected) return;
            
            const message = {
                user: 'Imperial System',
                text: text,
                time: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}),
                timestamp: Date.now(),
                type: 'system'
            };
            
            chatRef.push(message);
        }
        
        // –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
        function sendMessage() {
            const input = document.getElementById('chatInput');
            const messageText = input.value.trim();
            
            if (!messageText || !currentUser || !database || !isChatConnected) {
                if (messageText && currentUser && !isChatConnected) {
                    showNotification("Chat is not connected. Please try again.", "error");
                }
                return;
            }
            
            const message = {
                user: currentUser.name,
                text: messageText,
                time: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}),
                timestamp: Date.now(),
                type: 'user',
                userId: currentUser.username
            };
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
            chatRef.push(message);
            
            // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞
            input.value = '';
            
            // –£–¥–∞–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –Ω–∞–±–æ—Ä–∞
            currentUserTypingRef.remove();
            lastTypingTime = 0;
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –Ω–∞–±–æ—Ä–∞ —Ç–µ–∫—Å—Ç–∞
        function updateTypingStatus() {
            if (!database || !currentUserTypingRef || !isChatConnected) return;
            
            const now = Date.now();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –∫–∞–∂–¥—ã–µ 1.5 —Å–µ–∫—É–Ω–¥—ã
            if (now - lastTypingTime > 1500) {
                currentUserTypingRef.set({
                    name: currentUser.name,
                    timestamp: now
                });
                lastTypingTime = now;
                
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
                setTimeout(() => {
                    currentUserTypingRef.remove();
                }, 3000);
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –Ω–∞–±–æ—Ä–∞ —Ç–µ–∫—Å—Ç–∞ –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        function updateTypingIndicator(typingUsers) {
            const typingIndicator = document.getElementById('typingIndicator');
            if (!typingIndicator) return;
            
            // –£–¥–∞–ª—è–µ–º —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ —Å–ø–∏—Å–∫–∞
            delete typingUsers[currentUser?.username];
            
            const typingUsersArray = Object.values(typingUsers);
            
            if (typingUsersArray.length > 0) {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –¥–ª—è –ø–µ—Ä–≤—ã—Ö 2 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
                const names = typingUsersArray.slice(0, 2).map(u => u.name);
                let text = names.join(' and ');
                
                if (typingUsersArray.length > 2) {
                    text += ` and ${typingUsersArray.length - 2} more`;
                }
                
                typingIndicator.textContent = `${text} ${typingUsersArray.length === 1 ? 'is' : 'are'} typing...`;
                typingIndicator.style.display = 'block';
            } else {
                typingIndicator.style.display = 'none';
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —á–∞—Ç–∞
        function updateChatDisplay(messages) {
            const chatMessagesElement = document.getElementById('chatMessages');
            if (!chatMessagesElement) return;
            
            // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –æ–±—ä–µ–∫—Ç –≤ –º–∞—Å—Å–∏–≤ –∏ —Å–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –≤—Ä–µ–º–µ–Ω–∏
            const messagesArray = Object.values(messages).sort((a, b) => a.timestamp - b.timestamp);
            
            // –û—á–∏—â–∞–µ–º –∏ –¥–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è
            chatMessagesElement.innerHTML = '';
            
            if (messagesArray.length === 0) {
                chatMessagesElement.innerHTML = '<div class="chat-notice">Welcome to the Imperial Chat! Be respectful to other citizens.</div>';
            } else {
                messagesArray.forEach(msg => {
                    const messageDiv = document.createElement('div');
                    
                    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–ª–∞—Å—Å —Å–æ–æ–±—â–µ–Ω–∏—è
                    let messageClass = 'message';
                    if (msg.type === 'system') {
                        messageClass += ' system-message';
                    } else if (msg.userId === currentUser?.username) {
                        messageClass += ' user-message';
                    } else {
                        messageClass += ' other-message';
                    }
                    
                    messageDiv.className = messageClass;
                    
                    if (msg.type === 'system') {
                        messageDiv.innerHTML = `
                            <div class="message-content">${msg.text}</div>
                            <div class="message-time">${msg.time}</div>
                        `;
                    } else {
                        messageDiv.innerHTML = `
                            <div class="message-header">
                                <span class="message-user">${msg.user}</span>
                                <span class="message-time">${msg.time}</span>
                            </div>
                            <div class="message-content">${msg.text}</div>
                        `;
                    }
                    
                    chatMessagesElement.appendChild(messageDiv);
                });
            }
            
            // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –≤–Ω–∏–∑
            setTimeout(() => {
                chatMessagesElement.scrollTop = chatMessagesElement.scrollHeight;
            }, 100);
        }
        
        // –§—É–Ω–∫—Ü–∏—è –≤—ã—Ö–æ–¥–∞ –∏–∑ —á–∞—Ç–∞
        function disconnectFromChat() {
            if (!database || !currentUser) return;
            
            try {
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –≤—ã—Ö–æ–¥–µ
                sendSystemMessage(`${currentUser.name} has left the Imperial Chat`);
                
                // –£–¥–∞–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –æ–Ω–ª–∞–π–Ω
                if (usersRef) {
                    const userOnlineRef = usersRef.child(currentUser.username);
                    userOnlineRef.update({
                        online: false,
                        lastSeen: firebase.database.ServerValue.TIMESTAMP
                    });
                }
                
                // –£–¥–∞–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –Ω–∞–±–æ—Ä–∞
                if (currentUserTypingRef) {
                    currentUserTypingRef.remove();
                }
                
                // –û—Ç–∫–ª—é—á–∞–µ–º —Å–ª—É—à–∞—Ç–µ–ª–∏
                if (chatRef) chatRef.off();
                if (typingRef) typingRef.off();
                
                isChatConnected = false;
                updateChatStatus(false);
                
            } catch (error) {
                console.error("Chat disconnect error:", error);
            }
        }
        
        // –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π, —Ç–æ–ª—å–∫–æ –æ–±–Ω–æ–≤–ª—è–µ–º —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å —á–∞—Ç–æ–º:
        
        function login() {
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value;
            const errorElement = document.getElementById('loginError');
            
            if (users[username] && users[username].password === password) {
                currentUser = {
                    username: username,
                    ...users[username]
                };
                
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                closeLoginModal();
                
                document.getElementById('loginButtonContainer').style.display = 'none';
                document.getElementById('userMenu').classList.add('active');
                document.getElementById('userName').textContent = currentUser.name;
                
                // –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ —á–∞—Ç—É –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞
                if (firebaseApp) {
                    connectToChat();
                }
                
                showNotification(`Welcome to the Empire, ${currentUser.name}!`, "info");
            } else {
                errorElement.style.display = 'block';
                document.getElementById('username').style.borderColor = '#ff4444';
                document.getElementById('password').style.borderColor = '#ff4444';
            }
        }
        
        function logout() {
            // –û—Ç–∫–ª—é—á–∞–µ–º—Å—è –æ—Ç —á–∞—Ç–∞
            disconnectFromChat();
            
            currentUser = null;
            localStorage.removeItem('currentUser');
            localStorage.removeItem('chatSessionId');
            
            document.getElementById('userMenu').classList.remove('active');
            document.getElementById('loginButtonContainer').style.display = 'block';
            document.getElementById('userDropdown').classList.remove('active');
            
            closePersonalCabinet();
            closeChat();
            
            showNotification('You have left the Empire. Until we meet again!', "info");
        }
        
        function showChat() {
            document.getElementById('userDropdown').classList.remove('active');
            
            if (currentUser) {
                // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –Ω–∞–±–æ—Ä–∞ —Ç–µ–∫—Å—Ç–∞, –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
                if (!document.getElementById('typingIndicator')) {
                    const typingIndicator = document.createElement('div');
                    typingIndicator.id = 'typingIndicator';
                    typingIndicator.className = 'typing-indicator';
                    document.getElementById('chatMessages').parentNode.insertBefore(
                        typingIndicator, 
                        document.getElementById('chatMessages').nextSibling
                    );
                }
                
                document.getElementById('chatModal').classList.add('active');
                
                setTimeout(() => {
                    document.getElementById('chatInput').focus();
                }, 100);
            }
        }
        
        // –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (showPage, openTab, toggleTheme –∏ —Ç.–¥.) –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
        
    </script>
</body>
</html>
